var cr=Object.defineProperty;var vr=(r,e)=>{for(var n in e)cr(r,n,{get:e[n],enumerable:!0})};var I=1e-6,_=typeof Float32Array<"u"?Float32Array:Array;var o1=Math.PI/180,p1=180/Math.PI;var U={};vr(U,{add:()=>kr,adjoint:()=>pr,clone:()=>hr,copy:()=>lr,create:()=>xr,decompose:()=>_r,determinant:()=>Er,equals:()=>Jr,exactEquals:()=>Qr,frob:()=>$r,fromQuat:()=>Or,fromQuat2:()=>Ir,fromRotation:()=>Cr,fromRotationTranslation:()=>Z,fromRotationTranslationScale:()=>Dr,fromRotationTranslationScaleOrigin:()=>Nr,fromScaling:()=>Pr,fromTranslation:()=>wr,fromValues:()=>mr,fromXRotation:()=>Sr,fromYRotation:()=>Br,fromZRotation:()=>zr,frustum:()=>Gr,getRotation:()=>Ur,getScaling:()=>K,getTranslation:()=>Fr,identity:()=>$,invert:()=>or,lookAt:()=>qr,mul:()=>ur,multiply:()=>k,multiplyScalar:()=>Zr,multiplyScalarAndAdd:()=>Kr,ortho:()=>Vr,orthoNO:()=>J,orthoZO:()=>Xr,perspective:()=>Wr,perspectiveFromFieldOfView:()=>gr,perspectiveNO:()=>Q,perspectiveZO:()=>Yr,rotate:()=>Tr,rotateX:()=>yr,rotateY:()=>Lr,rotateZ:()=>Ar,scale:()=>br,set:()=>dr,str:()=>jr,sub:()=>r1,subtract:()=>u,targetTo:()=>Hr,translate:()=>Rr,transpose:()=>Mr});function xr(){var r=new _(16);return _!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function hr(r){var e=new _(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function lr(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function mr(r,e,n,a,i,t,s,c,f,v,x,l,m,d,M,o){var h=new _(16);return h[0]=r,h[1]=e,h[2]=n,h[3]=a,h[4]=i,h[5]=t,h[6]=s,h[7]=c,h[8]=f,h[9]=v,h[10]=x,h[11]=l,h[12]=m,h[13]=d,h[14]=M,h[15]=o,h}function dr(r,e,n,a,i,t,s,c,f,v,x,l,m,d,M,o,h){return r[0]=e,r[1]=n,r[2]=a,r[3]=i,r[4]=t,r[5]=s,r[6]=c,r[7]=f,r[8]=v,r[9]=x,r[10]=l,r[11]=m,r[12]=d,r[13]=M,r[14]=o,r[15]=h,r}function $(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Mr(r,e){if(r===e){var n=e[1],a=e[2],i=e[3],t=e[6],s=e[7],c=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=n,r[6]=e[9],r[7]=e[13],r[8]=a,r[9]=t,r[11]=e[14],r[12]=i,r[13]=s,r[14]=c}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function or(r,e){var n=e[0],a=e[1],i=e[2],t=e[3],s=e[4],c=e[5],f=e[6],v=e[7],x=e[8],l=e[9],m=e[10],d=e[11],M=e[12],o=e[13],h=e[14],T=e[15],L=n*c-a*s,p=n*f-i*s,E=n*v-t*s,b=a*f-i*c,R=a*v-t*c,w=i*v-t*f,A=x*o-l*M,C=x*h-m*M,y=x*T-d*M,S=l*h-m*o,B=l*T-d*o,z=m*T-d*h,P=L*z-p*B+E*S+b*y-R*C+w*A;return P?(P=1/P,r[0]=(c*z-f*B+v*S)*P,r[1]=(i*B-a*z-t*S)*P,r[2]=(o*w-h*R+T*b)*P,r[3]=(m*R-l*w-d*b)*P,r[4]=(f*y-s*z-v*C)*P,r[5]=(n*z-i*y+t*C)*P,r[6]=(h*E-M*w-T*p)*P,r[7]=(x*w-m*E+d*p)*P,r[8]=(s*B-c*y+v*A)*P,r[9]=(a*y-n*B-t*A)*P,r[10]=(M*R-o*E+T*L)*P,r[11]=(l*E-x*R-d*L)*P,r[12]=(c*C-s*S-f*A)*P,r[13]=(n*S-a*C+i*A)*P,r[14]=(o*p-M*b-h*L)*P,r[15]=(x*b-l*p+m*L)*P,r):null}function pr(r,e){var n=e[0],a=e[1],i=e[2],t=e[3],s=e[4],c=e[5],f=e[6],v=e[7],x=e[8],l=e[9],m=e[10],d=e[11],M=e[12],o=e[13],h=e[14],T=e[15],L=n*c-a*s,p=n*f-i*s,E=n*v-t*s,b=a*f-i*c,R=a*v-t*c,w=i*v-t*f,A=x*o-l*M,C=x*h-m*M,y=x*T-d*M,S=l*h-m*o,B=l*T-d*o,z=m*T-d*h;return r[0]=c*z-f*B+v*S,r[1]=i*B-a*z-t*S,r[2]=o*w-h*R+T*b,r[3]=m*R-l*w-d*b,r[4]=f*y-s*z-v*C,r[5]=n*z-i*y+t*C,r[6]=h*E-M*w-T*p,r[7]=x*w-m*E+d*p,r[8]=s*B-c*y+v*A,r[9]=a*y-n*B-t*A,r[10]=M*R-o*E+T*L,r[11]=l*E-x*R-d*L,r[12]=c*C-s*S-f*A,r[13]=n*S-a*C+i*A,r[14]=o*p-M*b-h*L,r[15]=x*b-l*p+m*L,r}function Er(r){var e=r[0],n=r[1],a=r[2],i=r[3],t=r[4],s=r[5],c=r[6],f=r[7],v=r[8],x=r[9],l=r[10],m=r[11],d=r[12],M=r[13],o=r[14],h=r[15],T=e*s-n*t,L=e*c-a*t,p=n*c-a*s,E=v*M-x*d,b=v*o-l*d,R=x*o-l*M,w=e*R-n*b+a*E,A=t*R-s*b+c*E,C=v*p-x*L+l*T,y=d*p-M*L+o*T;return f*w-i*A+h*C-m*y}function k(r,e,n){var a=e[0],i=e[1],t=e[2],s=e[3],c=e[4],f=e[5],v=e[6],x=e[7],l=e[8],m=e[9],d=e[10],M=e[11],o=e[12],h=e[13],T=e[14],L=e[15],p=n[0],E=n[1],b=n[2],R=n[3];return r[0]=p*a+E*c+b*l+R*o,r[1]=p*i+E*f+b*m+R*h,r[2]=p*t+E*v+b*d+R*T,r[3]=p*s+E*x+b*M+R*L,p=n[4],E=n[5],b=n[6],R=n[7],r[4]=p*a+E*c+b*l+R*o,r[5]=p*i+E*f+b*m+R*h,r[6]=p*t+E*v+b*d+R*T,r[7]=p*s+E*x+b*M+R*L,p=n[8],E=n[9],b=n[10],R=n[11],r[8]=p*a+E*c+b*l+R*o,r[9]=p*i+E*f+b*m+R*h,r[10]=p*t+E*v+b*d+R*T,r[11]=p*s+E*x+b*M+R*L,p=n[12],E=n[13],b=n[14],R=n[15],r[12]=p*a+E*c+b*l+R*o,r[13]=p*i+E*f+b*m+R*h,r[14]=p*t+E*v+b*d+R*T,r[15]=p*s+E*x+b*M+R*L,r}function Rr(r,e,n){var a=n[0],i=n[1],t=n[2],s,c,f,v,x,l,m,d,M,o,h,T;return e===r?(r[12]=e[0]*a+e[4]*i+e[8]*t+e[12],r[13]=e[1]*a+e[5]*i+e[9]*t+e[13],r[14]=e[2]*a+e[6]*i+e[10]*t+e[14],r[15]=e[3]*a+e[7]*i+e[11]*t+e[15]):(s=e[0],c=e[1],f=e[2],v=e[3],x=e[4],l=e[5],m=e[6],d=e[7],M=e[8],o=e[9],h=e[10],T=e[11],r[0]=s,r[1]=c,r[2]=f,r[3]=v,r[4]=x,r[5]=l,r[6]=m,r[7]=d,r[8]=M,r[9]=o,r[10]=h,r[11]=T,r[12]=s*a+x*i+M*t+e[12],r[13]=c*a+l*i+o*t+e[13],r[14]=f*a+m*i+h*t+e[14],r[15]=v*a+d*i+T*t+e[15]),r}function br(r,e,n){var a=n[0],i=n[1],t=n[2];return r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r[3]=e[3]*a,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Tr(r,e,n,a){var i=a[0],t=a[1],s=a[2],c=Math.sqrt(i*i+t*t+s*s),f,v,x,l,m,d,M,o,h,T,L,p,E,b,R,w,A,C,y,S,B,z,P,F;return c<I?null:(c=1/c,i*=c,t*=c,s*=c,f=Math.sin(n),v=Math.cos(n),x=1-v,l=e[0],m=e[1],d=e[2],M=e[3],o=e[4],h=e[5],T=e[6],L=e[7],p=e[8],E=e[9],b=e[10],R=e[11],w=i*i*x+v,A=t*i*x+s*f,C=s*i*x-t*f,y=i*t*x-s*f,S=t*t*x+v,B=s*t*x+i*f,z=i*s*x+t*f,P=t*s*x-i*f,F=s*s*x+v,r[0]=l*w+o*A+p*C,r[1]=m*w+h*A+E*C,r[2]=d*w+T*A+b*C,r[3]=M*w+L*A+R*C,r[4]=l*y+o*S+p*B,r[5]=m*y+h*S+E*B,r[6]=d*y+T*S+b*B,r[7]=M*y+L*S+R*B,r[8]=l*z+o*P+p*F,r[9]=m*z+h*P+E*F,r[10]=d*z+T*P+b*F,r[11]=M*z+L*P+R*F,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function yr(r,e,n){var a=Math.sin(n),i=Math.cos(n),t=e[4],s=e[5],c=e[6],f=e[7],v=e[8],x=e[9],l=e[10],m=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=t*i+v*a,r[5]=s*i+x*a,r[6]=c*i+l*a,r[7]=f*i+m*a,r[8]=v*i-t*a,r[9]=x*i-s*a,r[10]=l*i-c*a,r[11]=m*i-f*a,r}function Lr(r,e,n){var a=Math.sin(n),i=Math.cos(n),t=e[0],s=e[1],c=e[2],f=e[3],v=e[8],x=e[9],l=e[10],m=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=t*i-v*a,r[1]=s*i-x*a,r[2]=c*i-l*a,r[3]=f*i-m*a,r[8]=t*a+v*i,r[9]=s*a+x*i,r[10]=c*a+l*i,r[11]=f*a+m*i,r}function Ar(r,e,n){var a=Math.sin(n),i=Math.cos(n),t=e[0],s=e[1],c=e[2],f=e[3],v=e[4],x=e[5],l=e[6],m=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=t*i+v*a,r[1]=s*i+x*a,r[2]=c*i+l*a,r[3]=f*i+m*a,r[4]=v*i-t*a,r[5]=x*i-s*a,r[6]=l*i-c*a,r[7]=m*i-f*a,r}function wr(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Pr(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Cr(r,e,n){var a=n[0],i=n[1],t=n[2],s=Math.sqrt(a*a+i*i+t*t),c,f,v;return s<I?null:(s=1/s,a*=s,i*=s,t*=s,c=Math.sin(e),f=Math.cos(e),v=1-f,r[0]=a*a*v+f,r[1]=i*a*v+t*c,r[2]=t*a*v-i*c,r[3]=0,r[4]=a*i*v-t*c,r[5]=i*i*v+f,r[6]=t*i*v+a*c,r[7]=0,r[8]=a*t*v+i*c,r[9]=i*t*v-a*c,r[10]=t*t*v+f,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function Sr(r,e){var n=Math.sin(e),a=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=n,r[7]=0,r[8]=0,r[9]=-n,r[10]=a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Br(r,e){var n=Math.sin(e),a=Math.cos(e);return r[0]=a,r[1]=0,r[2]=-n,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=n,r[9]=0,r[10]=a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function zr(r,e){var n=Math.sin(e),a=Math.cos(e);return r[0]=a,r[1]=n,r[2]=0,r[3]=0,r[4]=-n,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Z(r,e,n){var a=e[0],i=e[1],t=e[2],s=e[3],c=a+a,f=i+i,v=t+t,x=a*c,l=a*f,m=a*v,d=i*f,M=i*v,o=t*v,h=s*c,T=s*f,L=s*v;return r[0]=1-(d+o),r[1]=l+L,r[2]=m-T,r[3]=0,r[4]=l-L,r[5]=1-(x+o),r[6]=M+h,r[7]=0,r[8]=m+T,r[9]=M-h,r[10]=1-(x+d),r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}function Ir(r,e){var n=new _(3),a=-e[0],i=-e[1],t=-e[2],s=e[3],c=e[4],f=e[5],v=e[6],x=e[7],l=a*a+i*i+t*t+s*s;return l>0?(n[0]=(c*s+x*a+f*t-v*i)*2/l,n[1]=(f*s+x*i+v*a-c*t)*2/l,n[2]=(v*s+x*t+c*i-f*a)*2/l):(n[0]=(c*s+x*a+f*t-v*i)*2,n[1]=(f*s+x*i+v*a-c*t)*2,n[2]=(v*s+x*t+c*i-f*a)*2),Z(r,e,n),r}function Fr(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function K(r,e){var n=e[0],a=e[1],i=e[2],t=e[4],s=e[5],c=e[6],f=e[8],v=e[9],x=e[10];return r[0]=Math.sqrt(n*n+a*a+i*i),r[1]=Math.sqrt(t*t+s*s+c*c),r[2]=Math.sqrt(f*f+v*v+x*x),r}function Ur(r,e){var n=new _(3);K(n,e);var a=1/n[0],i=1/n[1],t=1/n[2],s=e[0]*a,c=e[1]*i,f=e[2]*t,v=e[4]*a,x=e[5]*i,l=e[6]*t,m=e[8]*a,d=e[9]*i,M=e[10]*t,o=s+x+M,h=0;return o>0?(h=Math.sqrt(o+1)*2,r[3]=.25*h,r[0]=(l-d)/h,r[1]=(m-f)/h,r[2]=(c-v)/h):s>x&&s>M?(h=Math.sqrt(1+s-x-M)*2,r[3]=(l-d)/h,r[0]=.25*h,r[1]=(c+v)/h,r[2]=(m+f)/h):x>M?(h=Math.sqrt(1+x-s-M)*2,r[3]=(m-f)/h,r[0]=(c+v)/h,r[1]=.25*h,r[2]=(l+d)/h):(h=Math.sqrt(1+M-s-x)*2,r[3]=(c-v)/h,r[0]=(m+f)/h,r[1]=(l+d)/h,r[2]=.25*h),r}function _r(r,e,n,a){e[0]=a[12],e[1]=a[13],e[2]=a[14];var i=a[0],t=a[1],s=a[2],c=a[4],f=a[5],v=a[6],x=a[8],l=a[9],m=a[10];n[0]=Math.sqrt(i*i+t*t+s*s),n[1]=Math.sqrt(c*c+f*f+v*v),n[2]=Math.sqrt(x*x+l*l+m*m);var d=1/n[0],M=1/n[1],o=1/n[2],h=i*d,T=t*M,L=s*o,p=c*d,E=f*M,b=v*o,R=x*d,w=l*M,A=m*o,C=h+E+A,y=0;return C>0?(y=Math.sqrt(C+1)*2,r[3]=.25*y,r[0]=(b-w)/y,r[1]=(R-L)/y,r[2]=(T-p)/y):h>E&&h>A?(y=Math.sqrt(1+h-E-A)*2,r[3]=(b-w)/y,r[0]=.25*y,r[1]=(T+p)/y,r[2]=(R+L)/y):E>A?(y=Math.sqrt(1+E-h-A)*2,r[3]=(R-L)/y,r[0]=(T+p)/y,r[1]=.25*y,r[2]=(b+w)/y):(y=Math.sqrt(1+A-h-E)*2,r[3]=(T-p)/y,r[0]=(R+L)/y,r[1]=(b+w)/y,r[2]=.25*y),r}function Dr(r,e,n,a){var i=e[0],t=e[1],s=e[2],c=e[3],f=i+i,v=t+t,x=s+s,l=i*f,m=i*v,d=i*x,M=t*v,o=t*x,h=s*x,T=c*f,L=c*v,p=c*x,E=a[0],b=a[1],R=a[2];return r[0]=(1-(M+h))*E,r[1]=(m+p)*E,r[2]=(d-L)*E,r[3]=0,r[4]=(m-p)*b,r[5]=(1-(l+h))*b,r[6]=(o+T)*b,r[7]=0,r[8]=(d+L)*R,r[9]=(o-T)*R,r[10]=(1-(l+M))*R,r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}function Nr(r,e,n,a,i){var t=e[0],s=e[1],c=e[2],f=e[3],v=t+t,x=s+s,l=c+c,m=t*v,d=t*x,M=t*l,o=s*x,h=s*l,T=c*l,L=f*v,p=f*x,E=f*l,b=a[0],R=a[1],w=a[2],A=i[0],C=i[1],y=i[2],S=(1-(o+T))*b,B=(d+E)*b,z=(M-p)*b,P=(d-E)*R,F=(1-(m+T))*R,N=(h+L)*R,O=(M+p)*w,H=(h-L)*w,j=(1-(m+o))*w;return r[0]=S,r[1]=B,r[2]=z,r[3]=0,r[4]=P,r[5]=F,r[6]=N,r[7]=0,r[8]=O,r[9]=H,r[10]=j,r[11]=0,r[12]=n[0]+A-(S*A+P*C+O*y),r[13]=n[1]+C-(B*A+F*C+H*y),r[14]=n[2]+y-(z*A+N*C+j*y),r[15]=1,r}function Or(r,e){var n=e[0],a=e[1],i=e[2],t=e[3],s=n+n,c=a+a,f=i+i,v=n*s,x=a*s,l=a*c,m=i*s,d=i*c,M=i*f,o=t*s,h=t*c,T=t*f;return r[0]=1-l-M,r[1]=x+T,r[2]=m-h,r[3]=0,r[4]=x-T,r[5]=1-v-M,r[6]=d+o,r[7]=0,r[8]=m+h,r[9]=d-o,r[10]=1-v-l,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Gr(r,e,n,a,i,t,s){var c=1/(n-e),f=1/(i-a),v=1/(t-s);return r[0]=t*2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t*2*f,r[6]=0,r[7]=0,r[8]=(n+e)*c,r[9]=(i+a)*f,r[10]=(s+t)*v,r[11]=-1,r[12]=0,r[13]=0,r[14]=s*t*2*v,r[15]=0,r}function Q(r,e,n,a,i){var t=1/Math.tan(e/2);if(r[0]=t/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0){var s=1/(a-i);r[10]=(i+a)*s,r[14]=2*i*a*s}else r[10]=-1,r[14]=-2*a;return r}var Wr=Q;function Yr(r,e,n,a,i){var t=1/Math.tan(e/2);if(r[0]=t/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0){var s=1/(a-i);r[10]=i*s,r[14]=i*a*s}else r[10]=-1,r[14]=-a;return r}function gr(r,e,n,a){var i=Math.tan(e.upDegrees*Math.PI/180),t=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),c=Math.tan(e.rightDegrees*Math.PI/180),f=2/(s+c),v=2/(i+t);return r[0]=f,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=v,r[6]=0,r[7]=0,r[8]=-((s-c)*f*.5),r[9]=(i-t)*v*.5,r[10]=a/(n-a),r[11]=-1,r[12]=0,r[13]=0,r[14]=a*n/(n-a),r[15]=0,r}function J(r,e,n,a,i,t,s){var c=1/(e-n),f=1/(a-i),v=1/(t-s);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*f,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*v,r[11]=0,r[12]=(e+n)*c,r[13]=(i+a)*f,r[14]=(s+t)*v,r[15]=1,r}var Vr=J;function Xr(r,e,n,a,i,t,s){var c=1/(e-n),f=1/(a-i),v=1/(t-s);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*f,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=v,r[11]=0,r[12]=(e+n)*c,r[13]=(i+a)*f,r[14]=t*v,r[15]=1,r}function qr(r,e,n,a){var i,t,s,c,f,v,x,l,m,d,M=e[0],o=e[1],h=e[2],T=a[0],L=a[1],p=a[2],E=n[0],b=n[1],R=n[2];return Math.abs(M-E)<I&&Math.abs(o-b)<I&&Math.abs(h-R)<I?$(r):(x=M-E,l=o-b,m=h-R,d=1/Math.sqrt(x*x+l*l+m*m),x*=d,l*=d,m*=d,i=L*m-p*l,t=p*x-T*m,s=T*l-L*x,d=Math.sqrt(i*i+t*t+s*s),d?(d=1/d,i*=d,t*=d,s*=d):(i=0,t=0,s=0),c=l*s-m*t,f=m*i-x*s,v=x*t-l*i,d=Math.sqrt(c*c+f*f+v*v),d?(d=1/d,c*=d,f*=d,v*=d):(c=0,f=0,v=0),r[0]=i,r[1]=c,r[2]=x,r[3]=0,r[4]=t,r[5]=f,r[6]=l,r[7]=0,r[8]=s,r[9]=v,r[10]=m,r[11]=0,r[12]=-(i*M+t*o+s*h),r[13]=-(c*M+f*o+v*h),r[14]=-(x*M+l*o+m*h),r[15]=1,r)}function Hr(r,e,n,a){var i=e[0],t=e[1],s=e[2],c=a[0],f=a[1],v=a[2],x=i-n[0],l=t-n[1],m=s-n[2],d=x*x+l*l+m*m;d>0&&(d=1/Math.sqrt(d),x*=d,l*=d,m*=d);var M=f*m-v*l,o=v*x-c*m,h=c*l-f*x;return d=M*M+o*o+h*h,d>0&&(d=1/Math.sqrt(d),M*=d,o*=d,h*=d),r[0]=M,r[1]=o,r[2]=h,r[3]=0,r[4]=l*h-m*o,r[5]=m*M-x*h,r[6]=x*o-l*M,r[7]=0,r[8]=x,r[9]=l,r[10]=m,r[11]=0,r[12]=i,r[13]=t,r[14]=s,r[15]=1,r}function jr(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function $r(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]+r[3]*r[3]+r[4]*r[4]+r[5]*r[5]+r[6]*r[6]+r[7]*r[7]+r[8]*r[8]+r[9]*r[9]+r[10]*r[10]+r[11]*r[11]+r[12]*r[12]+r[13]*r[13]+r[14]*r[14]+r[15]*r[15])}function kr(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r[4]=e[4]+n[4],r[5]=e[5]+n[5],r[6]=e[6]+n[6],r[7]=e[7]+n[7],r[8]=e[8]+n[8],r[9]=e[9]+n[9],r[10]=e[10]+n[10],r[11]=e[11]+n[11],r[12]=e[12]+n[12],r[13]=e[13]+n[13],r[14]=e[14]+n[14],r[15]=e[15]+n[15],r}function u(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r[4]=e[4]-n[4],r[5]=e[5]-n[5],r[6]=e[6]-n[6],r[7]=e[7]-n[7],r[8]=e[8]-n[8],r[9]=e[9]-n[9],r[10]=e[10]-n[10],r[11]=e[11]-n[11],r[12]=e[12]-n[12],r[13]=e[13]-n[13],r[14]=e[14]-n[14],r[15]=e[15]-n[15],r}function Zr(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[7]=e[7]*n,r[8]=e[8]*n,r[9]=e[9]*n,r[10]=e[10]*n,r[11]=e[11]*n,r[12]=e[12]*n,r[13]=e[13]*n,r[14]=e[14]*n,r[15]=e[15]*n,r}function Kr(r,e,n,a){return r[0]=e[0]+n[0]*a,r[1]=e[1]+n[1]*a,r[2]=e[2]+n[2]*a,r[3]=e[3]+n[3]*a,r[4]=e[4]+n[4]*a,r[5]=e[5]+n[5]*a,r[6]=e[6]+n[6]*a,r[7]=e[7]+n[7]*a,r[8]=e[8]+n[8]*a,r[9]=e[9]+n[9]*a,r[10]=e[10]+n[10]*a,r[11]=e[11]+n[11]*a,r[12]=e[12]+n[12]*a,r[13]=e[13]+n[13]*a,r[14]=e[14]+n[14]*a,r[15]=e[15]+n[15]*a,r}function Qr(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]}function Jr(r,e){var n=r[0],a=r[1],i=r[2],t=r[3],s=r[4],c=r[5],f=r[6],v=r[7],x=r[8],l=r[9],m=r[10],d=r[11],M=r[12],o=r[13],h=r[14],T=r[15],L=e[0],p=e[1],E=e[2],b=e[3],R=e[4],w=e[5],A=e[6],C=e[7],y=e[8],S=e[9],B=e[10],z=e[11],P=e[12],F=e[13],N=e[14],O=e[15];return Math.abs(n-L)<=I*Math.max(1,Math.abs(n),Math.abs(L))&&Math.abs(a-p)<=I*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(i-E)<=I*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(t-b)<=I*Math.max(1,Math.abs(t),Math.abs(b))&&Math.abs(s-R)<=I*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(c-w)<=I*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(f-A)<=I*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(v-C)<=I*Math.max(1,Math.abs(v),Math.abs(C))&&Math.abs(x-y)<=I*Math.max(1,Math.abs(x),Math.abs(y))&&Math.abs(l-S)<=I*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(m-B)<=I*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(d-z)<=I*Math.max(1,Math.abs(d),Math.abs(z))&&Math.abs(M-P)<=I*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(o-F)<=I*Math.max(1,Math.abs(o),Math.abs(F))&&Math.abs(h-N)<=I*Math.max(1,Math.abs(h),Math.abs(N))&&Math.abs(T-O)<=I*Math.max(1,Math.abs(T),Math.abs(O))}var ur=k,r1=u;function rr(r,e,n,a,i){r.clearColor(1,1,1,1),r.clearDepth(1),r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT);let t=45*Math.PI/180;var s,c;r.canvas instanceof HTMLCanvasElement?(s=r.canvas.clientWidth,c=r.canvas.clientHeight):(s=r.canvas.width,c=r.canvas.height);let f=s/c,v=.1,x=100,l=U.create();U.perspective(l,t,f,v,x);let m=U.create();U.translate(m,m,[-0,0,-6]),U.rotate(m,m,i.z,[0,0,1]),U.rotate(m,m,i.y,[0,1,0]),U.rotate(m,m,i.x,[1,0,0]),e1(r,n,e),n1(r,n,e),a1(r,n,e),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n.indices),r.useProgram(e.program),r.uniformMatrix4fv(e.uniformLocations.projectionMatrix,!1,l),r.uniformMatrix4fv(e.uniformLocations.modelViewMatrix,!1,m),a&&(r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a),r.uniform1i(e.uniformLocations.uSampler,0));{let M=r.UNSIGNED_SHORT;r.drawElements(r.TRIANGLES,36,M,0)}}function e1(r,e,n){let i=r.FLOAT,t=!1,s=0,c=0;r.bindBuffer(r.ARRAY_BUFFER,e.position),r.vertexAttribPointer(n.attribLocations.vertexPosition,3,i,t,s,c),r.enableVertexAttribArray(n.attribLocations.vertexPosition)}function n1(r,e,n){let i=r.FLOAT,t=!1,s=0,c=0;r.bindBuffer(r.ARRAY_BUFFER,e.color),r.vertexAttribPointer(n.attribLocations.vertexColor,4,i,t,s,c),r.enableVertexAttribArray(n.attribLocations.vertexColor)}function a1(r,e,n){let i=r.FLOAT,t=!1,s=0,c=0;r.bindBuffer(r.ARRAY_BUFFER,e.textureCoord),r.vertexAttribPointer(n.attribLocations.textureCoord,2,i,t,s,c),r.enableVertexAttribArray(n.attribLocations.textureCoord)}function er(r){let e=i1(r);if(!e)throw Error("Failed to initialize position buffer");let n=t1(r);if(!n)throw Error("Failed to initialize color buffer");let a=s1(r);if(!a)throw Error("Failed to initialize texture buffer");let i=c1(r);if(!i)throw Error("Failed to initialize position buffer");return{position:e,color:n,textureCoord:a,indices:i}}function i1(r){let e=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,e);let n=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1];return r.bufferData(r.ARRAY_BUFFER,new Float32Array(n),r.STATIC_DRAW),e}function t1(r){let e=[[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]];var n=[],a;for(a=0;a<e.length;++a){let t=e[a];n=n.concat(t,t,t,t)}let i=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,i),r.bufferData(r.ARRAY_BUFFER,new Float32Array(n),r.STATIC_DRAW),i}function s1(r){let a=.3333333333333333,i=1/2,t=[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}],s=[];for(let f of t){let v=f.col*a,x=(f.col+1)*a,l=f.row*i,m=(f.row+1)*i;s.push(v,l,x,l,x,m,v,m)}let c=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,c),r.bufferData(r.ARRAY_BUFFER,new Float32Array(s),r.STATIC_DRAW),c}function c1(r){let e=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e);let n=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),r.STATIC_DRAW),e}var q=[],D=null,g={x:0,y:0,z:0},G={x:0,y:0,z:0},W={x:0,y:0,z:0},Y=null,v1=1e3;async function f1(){try{let r=await fetch("/answers");if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return(await r.json()).answers||[]}catch(r){throw console.error("Failed to fetch answers:",r),r}}function x1(r,e,n){let a=e.split(/\s+/).filter(Boolean),i=[],t="";for(let s of a){let c=t?`${t} ${s}`:s;r.measureText(c).width>n&&t?(i.push(t),t=s):t=c}return t&&i.push(t),i.length?i:[e]}function h1(){let r=document.getElementById("hate-ball-canvas");if(!r){V("Canvas element not found.");return}let e=r.getContext("webgl");if(!e||e===null){V("Failed to get rendering context this is a bug :(");return}e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT);let i=d1(e,`
        attribute vec4 aVertexPosition;
        attribute vec4 aVertexColor;
        attribute vec2 aTextureCoord;

        uniform mat4 uModelViewMatrix;
        uniform mat4 uProjectionMatrix;

        varying lowp vec4 vColor;
        varying highp vec2 vTextureCoord;

        void main(void) {
        gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;
        vColor = aVertexColor;
        vTextureCoord = aTextureCoord;
        }
    `,`
        varying lowp vec4 vColor;
        varying highp vec2 vTextureCoord;
        uniform sampler2D uSampler;

        void main(void) {
        gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;
        }
    `);if(!i)throw Error("Shader program failed to initialize.");let t={program:i,attribLocations:{vertexPosition:e.getAttribLocation(i,"aVertexPosition"),vertexColor:e.getAttribLocation(i,"aVertexColor"),textureCoord:e.getAttribLocation(i,"aTextureCoord")},uniformLocations:{projectionMatrix:e.getUniformLocation(i,"uProjectionMatrix"),modelViewMatrix:e.getUniformLocation(i,"uModelViewMatrix"),uSampler:e.getUniformLocation(i,"uSampler")}},s=er(e);D=m1(e),tr(e,D,q),ir();function c(f,v){l1(f),D?.needsUpdate&&sr(v,D),rr(v,t,s,D?.texture??null,g),window.requestAnimationFrame(x=>c(x,v))}window.requestAnimationFrame(f=>c(f,e))}async function V(r){console.error(r);let e=document.getElementById("error");e&&(e.textContent=r,e.classList.remove("hidden"))}async function nr(){let r=document.getElementById("error");try{let e=await f1();if(!e.length)V("No answers received from the server.");else{console.debug(`Received answers: ${e.join(" | ")}`),q=e;let a=document.getElementById("hate-ball-canvas")?.getContext("webgl");a&&D&&tr(a,D,q),ir(),r&&r.classList.add("hidden")}}catch(e){V(`Error fetching answer: ${e}`)}}function ir(){G={x:Math.random()*Math.PI*2,y:Math.random()*Math.PI*2,z:Math.random()*Math.PI*2},g={...G},Y=performance.now()}function l1(r){if(Y===null)return;let e=(r-Y)/v1;if(e>=1){g={...W},Y=null;return}let n=1-(1-e)**3;g={x:X(G.x,W.x,n),y:X(G.y,W.y,n),z:X(G.z,W.z,n)}}function X(r,e,n){return r+(e-r)*n}function m1(r){let e=document.createElement("canvas");e.width=768,e.height=512;let n=e.getContext("2d");if(!n)throw new Error("Unable to create 2D context for text texture");let a=r.createTexture();if(!a)throw new Error("Unable to create WebGL texture");return r.bindTexture(r.TEXTURE_2D,a),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width,e.height,0,r.RGBA,r.UNSIGNED_BYTE,null),{texture:a,canvas:e,ctx:n,needsUpdate:!0}}function tr(r,e,n){let{canvas:a,ctx:i}=e,t=3,s=2,c=a.width/t,f=a.height/s,v=20,x="#111111",l="#ffffff",m="#d64b4b",d="#45b86f",M="#1253ae",o="#e0c24d",T=[x,m,d,M,o,"#4b0067"];T.sort(()=>Math.random()-.5);let L=n.length?n:["..."];i.clearRect(0,0,a.width,a.height),i.textAlign="center",i.textBaseline="middle",i.font="bold 22px sans-serif";for(let p=0;p<t*s;p+=1){let E=p%t,b=Math.floor(p/t),R=E*c,w=b*f;i.fillStyle=T[p%T.length],i.fillRect(R,w,c,f);let A=L[p%L.length],C=c-v*2;[o,d].includes(i.fillStyle)?i.fillStyle=x:i.fillStyle=l;let y=x1(i,A,C),S=26,B=R+c/2,P=w+f/2-(y.length-1)*S/2;for(let F=0;F<y.length;F+=1)i.fillText(y[F],B,P+F*S)}e.needsUpdate=!0,sr(r,e)}function sr(r,e){r.bindTexture(r.TEXTURE_2D,e.texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e.canvas),e.needsUpdate=!1}function d1(r,e,n){let a=ar(r,r.VERTEX_SHADER,e),i=ar(r,r.FRAGMENT_SHADER,n);if(!a||!i)throw new Error("Shader creation failed");let t=r.createProgram();return r.attachShader(t,a),r.attachShader(t,i),r.linkProgram(t),r.getProgramParameter(t,r.LINK_STATUS)?t:(alert(`Unable to initialize the shader program: ${r.getProgramInfoLog(t)}`),null)}function ar(r,e,n){let a=r.createShader(e);if(!a)throw new Error("Unable to create shader");return r.shaderSource(a,n),r.compileShader(a),r.getShaderParameter(a,r.COMPILE_STATUS)?a:(alert(`An error occurred compiling the shaders: ${r.getShaderInfoLog(a)}`),r.deleteShader(a),null)}document.addEventListener("DOMContentLoaded",()=>{let r=document.getElementById("get_answer");r&&r.addEventListener("click",nr),h1(),nr()});
