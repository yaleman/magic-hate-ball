var ar=Object.defineProperty;var ir=(r,e)=>{for(var n in e)ar(r,n,{get:e[n],enumerable:!0})};var z=1e-6,_=typeof Float32Array<"u"?Float32Array:Array;var x1=Math.PI/180,h1=180/Math.PI;var U={};ir(U,{add:()=>qr,adjoint:()=>mr,clone:()=>cr,copy:()=>vr,create:()=>sr,decompose:()=>Ir,determinant:()=>Mr,equals:()=>kr,exactEquals:()=>$r,frob:()=>Xr,fromQuat:()=>Ur,fromQuat2:()=>Pr,fromRotation:()=>wr,fromRotationTranslation:()=>q,fromRotationTranslationScale:()=>zr,fromRotationTranslationScaleOrigin:()=>Fr,fromScaling:()=>Lr,fromTranslation:()=>br,fromValues:()=>fr,fromXRotation:()=>Ar,fromYRotation:()=>yr,fromZRotation:()=>Cr,frustum:()=>_r,getRotation:()=>Br,getScaling:()=>H,getTranslation:()=>Sr,identity:()=>V,invert:()=>dr,lookAt:()=>Yr,mul:()=>Zr,multiply:()=>X,multiplyScalar:()=>Hr,multiplyScalarAndAdd:()=>jr,ortho:()=>Gr,orthoNO:()=>$,orthoZO:()=>Wr,perspective:()=>Dr,perspectiveFromFieldOfView:()=>Or,perspectiveNO:()=>j,perspectiveZO:()=>Nr,rotate:()=>Er,rotateX:()=>Tr,rotateY:()=>or,rotateZ:()=>Rr,scale:()=>pr,set:()=>xr,str:()=>Vr,sub:()=>Kr,subtract:()=>k,targetTo:()=>gr,translate:()=>lr,transpose:()=>hr});function sr(){var r=new _(16);return _!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function cr(r){var e=new _(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function vr(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function fr(r,e,n,a,i,t,s,c,f,v,x,m,h,M,l,p){var d=new _(16);return d[0]=r,d[1]=e,d[2]=n,d[3]=a,d[4]=i,d[5]=t,d[6]=s,d[7]=c,d[8]=f,d[9]=v,d[10]=x,d[11]=m,d[12]=h,d[13]=M,d[14]=l,d[15]=p,d}function xr(r,e,n,a,i,t,s,c,f,v,x,m,h,M,l,p,d){return r[0]=e,r[1]=n,r[2]=a,r[3]=i,r[4]=t,r[5]=s,r[6]=c,r[7]=f,r[8]=v,r[9]=x,r[10]=m,r[11]=h,r[12]=M,r[13]=l,r[14]=p,r[15]=d,r}function V(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function hr(r,e){if(r===e){var n=e[1],a=e[2],i=e[3],t=e[6],s=e[7],c=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=n,r[6]=e[9],r[7]=e[13],r[8]=a,r[9]=t,r[11]=e[14],r[12]=i,r[13]=s,r[14]=c}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function dr(r,e){var n=e[0],a=e[1],i=e[2],t=e[3],s=e[4],c=e[5],f=e[6],v=e[7],x=e[8],m=e[9],h=e[10],M=e[11],l=e[12],p=e[13],d=e[14],b=e[15],w=n*c-a*s,T=n*f-i*s,E=n*v-t*s,o=a*f-i*c,R=a*v-t*c,y=i*v-t*f,A=x*p-m*l,P=x*d-h*l,L=x*b-M*l,S=m*d-h*p,B=m*b-M*p,I=h*b-M*d,C=w*I-T*B+E*S+o*L-R*P+y*A;return C?(C=1/C,r[0]=(c*I-f*B+v*S)*C,r[1]=(i*B-a*I-t*S)*C,r[2]=(p*y-d*R+b*o)*C,r[3]=(h*R-m*y-M*o)*C,r[4]=(f*L-s*I-v*P)*C,r[5]=(n*I-i*L+t*P)*C,r[6]=(d*E-l*y-b*T)*C,r[7]=(x*y-h*E+M*T)*C,r[8]=(s*B-c*L+v*A)*C,r[9]=(a*L-n*B-t*A)*C,r[10]=(l*R-p*E+b*w)*C,r[11]=(m*E-x*R-M*w)*C,r[12]=(c*P-s*S-f*A)*C,r[13]=(n*S-a*P+i*A)*C,r[14]=(p*T-l*o-d*w)*C,r[15]=(x*o-m*T+h*w)*C,r):null}function mr(r,e){var n=e[0],a=e[1],i=e[2],t=e[3],s=e[4],c=e[5],f=e[6],v=e[7],x=e[8],m=e[9],h=e[10],M=e[11],l=e[12],p=e[13],d=e[14],b=e[15],w=n*c-a*s,T=n*f-i*s,E=n*v-t*s,o=a*f-i*c,R=a*v-t*c,y=i*v-t*f,A=x*p-m*l,P=x*d-h*l,L=x*b-M*l,S=m*d-h*p,B=m*b-M*p,I=h*b-M*d;return r[0]=c*I-f*B+v*S,r[1]=i*B-a*I-t*S,r[2]=p*y-d*R+b*o,r[3]=h*R-m*y-M*o,r[4]=f*L-s*I-v*P,r[5]=n*I-i*L+t*P,r[6]=d*E-l*y-b*T,r[7]=x*y-h*E+M*T,r[8]=s*B-c*L+v*A,r[9]=a*L-n*B-t*A,r[10]=l*R-p*E+b*w,r[11]=m*E-x*R-M*w,r[12]=c*P-s*S-f*A,r[13]=n*S-a*P+i*A,r[14]=p*T-l*o-d*w,r[15]=x*o-m*T+h*w,r}function Mr(r){var e=r[0],n=r[1],a=r[2],i=r[3],t=r[4],s=r[5],c=r[6],f=r[7],v=r[8],x=r[9],m=r[10],h=r[11],M=r[12],l=r[13],p=r[14],d=r[15],b=e*s-n*t,w=e*c-a*t,T=n*c-a*s,E=v*l-x*M,o=v*p-m*M,R=x*p-m*l,y=e*R-n*o+a*E,A=t*R-s*o+c*E,P=v*T-x*w+m*b,L=M*T-l*w+p*b;return f*y-i*A+d*P-h*L}function X(r,e,n){var a=e[0],i=e[1],t=e[2],s=e[3],c=e[4],f=e[5],v=e[6],x=e[7],m=e[8],h=e[9],M=e[10],l=e[11],p=e[12],d=e[13],b=e[14],w=e[15],T=n[0],E=n[1],o=n[2],R=n[3];return r[0]=T*a+E*c+o*m+R*p,r[1]=T*i+E*f+o*h+R*d,r[2]=T*t+E*v+o*M+R*b,r[3]=T*s+E*x+o*l+R*w,T=n[4],E=n[5],o=n[6],R=n[7],r[4]=T*a+E*c+o*m+R*p,r[5]=T*i+E*f+o*h+R*d,r[6]=T*t+E*v+o*M+R*b,r[7]=T*s+E*x+o*l+R*w,T=n[8],E=n[9],o=n[10],R=n[11],r[8]=T*a+E*c+o*m+R*p,r[9]=T*i+E*f+o*h+R*d,r[10]=T*t+E*v+o*M+R*b,r[11]=T*s+E*x+o*l+R*w,T=n[12],E=n[13],o=n[14],R=n[15],r[12]=T*a+E*c+o*m+R*p,r[13]=T*i+E*f+o*h+R*d,r[14]=T*t+E*v+o*M+R*b,r[15]=T*s+E*x+o*l+R*w,r}function lr(r,e,n){var a=n[0],i=n[1],t=n[2],s,c,f,v,x,m,h,M,l,p,d,b;return e===r?(r[12]=e[0]*a+e[4]*i+e[8]*t+e[12],r[13]=e[1]*a+e[5]*i+e[9]*t+e[13],r[14]=e[2]*a+e[6]*i+e[10]*t+e[14],r[15]=e[3]*a+e[7]*i+e[11]*t+e[15]):(s=e[0],c=e[1],f=e[2],v=e[3],x=e[4],m=e[5],h=e[6],M=e[7],l=e[8],p=e[9],d=e[10],b=e[11],r[0]=s,r[1]=c,r[2]=f,r[3]=v,r[4]=x,r[5]=m,r[6]=h,r[7]=M,r[8]=l,r[9]=p,r[10]=d,r[11]=b,r[12]=s*a+x*i+l*t+e[12],r[13]=c*a+m*i+p*t+e[13],r[14]=f*a+h*i+d*t+e[14],r[15]=v*a+M*i+b*t+e[15]),r}function pr(r,e,n){var a=n[0],i=n[1],t=n[2];return r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r[3]=e[3]*a,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Er(r,e,n,a){var i=a[0],t=a[1],s=a[2],c=Math.sqrt(i*i+t*t+s*s),f,v,x,m,h,M,l,p,d,b,w,T,E,o,R,y,A,P,L,S,B,I,C,F;return c<z?null:(c=1/c,i*=c,t*=c,s*=c,f=Math.sin(n),v=Math.cos(n),x=1-v,m=e[0],h=e[1],M=e[2],l=e[3],p=e[4],d=e[5],b=e[6],w=e[7],T=e[8],E=e[9],o=e[10],R=e[11],y=i*i*x+v,A=t*i*x+s*f,P=s*i*x-t*f,L=i*t*x-s*f,S=t*t*x+v,B=s*t*x+i*f,I=i*s*x+t*f,C=t*s*x-i*f,F=s*s*x+v,r[0]=m*y+p*A+T*P,r[1]=h*y+d*A+E*P,r[2]=M*y+b*A+o*P,r[3]=l*y+w*A+R*P,r[4]=m*L+p*S+T*B,r[5]=h*L+d*S+E*B,r[6]=M*L+b*S+o*B,r[7]=l*L+w*S+R*B,r[8]=m*I+p*C+T*F,r[9]=h*I+d*C+E*F,r[10]=M*I+b*C+o*F,r[11]=l*I+w*C+R*F,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function Tr(r,e,n){var a=Math.sin(n),i=Math.cos(n),t=e[4],s=e[5],c=e[6],f=e[7],v=e[8],x=e[9],m=e[10],h=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=t*i+v*a,r[5]=s*i+x*a,r[6]=c*i+m*a,r[7]=f*i+h*a,r[8]=v*i-t*a,r[9]=x*i-s*a,r[10]=m*i-c*a,r[11]=h*i-f*a,r}function or(r,e,n){var a=Math.sin(n),i=Math.cos(n),t=e[0],s=e[1],c=e[2],f=e[3],v=e[8],x=e[9],m=e[10],h=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=t*i-v*a,r[1]=s*i-x*a,r[2]=c*i-m*a,r[3]=f*i-h*a,r[8]=t*a+v*i,r[9]=s*a+x*i,r[10]=c*a+m*i,r[11]=f*a+h*i,r}function Rr(r,e,n){var a=Math.sin(n),i=Math.cos(n),t=e[0],s=e[1],c=e[2],f=e[3],v=e[4],x=e[5],m=e[6],h=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=t*i+v*a,r[1]=s*i+x*a,r[2]=c*i+m*a,r[3]=f*i+h*a,r[4]=v*i-t*a,r[5]=x*i-s*a,r[6]=m*i-c*a,r[7]=h*i-f*a,r}function br(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Lr(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function wr(r,e,n){var a=n[0],i=n[1],t=n[2],s=Math.sqrt(a*a+i*i+t*t),c,f,v;return s<z?null:(s=1/s,a*=s,i*=s,t*=s,c=Math.sin(e),f=Math.cos(e),v=1-f,r[0]=a*a*v+f,r[1]=i*a*v+t*c,r[2]=t*a*v-i*c,r[3]=0,r[4]=a*i*v-t*c,r[5]=i*i*v+f,r[6]=t*i*v+a*c,r[7]=0,r[8]=a*t*v+i*c,r[9]=i*t*v-a*c,r[10]=t*t*v+f,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function Ar(r,e){var n=Math.sin(e),a=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=n,r[7]=0,r[8]=0,r[9]=-n,r[10]=a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function yr(r,e){var n=Math.sin(e),a=Math.cos(e);return r[0]=a,r[1]=0,r[2]=-n,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=n,r[9]=0,r[10]=a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Cr(r,e){var n=Math.sin(e),a=Math.cos(e);return r[0]=a,r[1]=n,r[2]=0,r[3]=0,r[4]=-n,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function q(r,e,n){var a=e[0],i=e[1],t=e[2],s=e[3],c=a+a,f=i+i,v=t+t,x=a*c,m=a*f,h=a*v,M=i*f,l=i*v,p=t*v,d=s*c,b=s*f,w=s*v;return r[0]=1-(M+p),r[1]=m+w,r[2]=h-b,r[3]=0,r[4]=m-w,r[5]=1-(x+p),r[6]=l+d,r[7]=0,r[8]=h+b,r[9]=l-d,r[10]=1-(x+M),r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}function Pr(r,e){var n=new _(3),a=-e[0],i=-e[1],t=-e[2],s=e[3],c=e[4],f=e[5],v=e[6],x=e[7],m=a*a+i*i+t*t+s*s;return m>0?(n[0]=(c*s+x*a+f*t-v*i)*2/m,n[1]=(f*s+x*i+v*a-c*t)*2/m,n[2]=(v*s+x*t+c*i-f*a)*2/m):(n[0]=(c*s+x*a+f*t-v*i)*2,n[1]=(f*s+x*i+v*a-c*t)*2,n[2]=(v*s+x*t+c*i-f*a)*2),q(r,e,n),r}function Sr(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function H(r,e){var n=e[0],a=e[1],i=e[2],t=e[4],s=e[5],c=e[6],f=e[8],v=e[9],x=e[10];return r[0]=Math.sqrt(n*n+a*a+i*i),r[1]=Math.sqrt(t*t+s*s+c*c),r[2]=Math.sqrt(f*f+v*v+x*x),r}function Br(r,e){var n=new _(3);H(n,e);var a=1/n[0],i=1/n[1],t=1/n[2],s=e[0]*a,c=e[1]*i,f=e[2]*t,v=e[4]*a,x=e[5]*i,m=e[6]*t,h=e[8]*a,M=e[9]*i,l=e[10]*t,p=s+x+l,d=0;return p>0?(d=Math.sqrt(p+1)*2,r[3]=.25*d,r[0]=(m-M)/d,r[1]=(h-f)/d,r[2]=(c-v)/d):s>x&&s>l?(d=Math.sqrt(1+s-x-l)*2,r[3]=(m-M)/d,r[0]=.25*d,r[1]=(c+v)/d,r[2]=(h+f)/d):x>l?(d=Math.sqrt(1+x-s-l)*2,r[3]=(h-f)/d,r[0]=(c+v)/d,r[1]=.25*d,r[2]=(m+M)/d):(d=Math.sqrt(1+l-s-x)*2,r[3]=(c-v)/d,r[0]=(h+f)/d,r[1]=(m+M)/d,r[2]=.25*d),r}function Ir(r,e,n,a){e[0]=a[12],e[1]=a[13],e[2]=a[14];var i=a[0],t=a[1],s=a[2],c=a[4],f=a[5],v=a[6],x=a[8],m=a[9],h=a[10];n[0]=Math.sqrt(i*i+t*t+s*s),n[1]=Math.sqrt(c*c+f*f+v*v),n[2]=Math.sqrt(x*x+m*m+h*h);var M=1/n[0],l=1/n[1],p=1/n[2],d=i*M,b=t*l,w=s*p,T=c*M,E=f*l,o=v*p,R=x*M,y=m*l,A=h*p,P=d+E+A,L=0;return P>0?(L=Math.sqrt(P+1)*2,r[3]=.25*L,r[0]=(o-y)/L,r[1]=(R-w)/L,r[2]=(b-T)/L):d>E&&d>A?(L=Math.sqrt(1+d-E-A)*2,r[3]=(o-y)/L,r[0]=.25*L,r[1]=(b+T)/L,r[2]=(R+w)/L):E>A?(L=Math.sqrt(1+E-d-A)*2,r[3]=(R-w)/L,r[0]=(b+T)/L,r[1]=.25*L,r[2]=(o+y)/L):(L=Math.sqrt(1+A-d-E)*2,r[3]=(b-T)/L,r[0]=(R+w)/L,r[1]=(o+y)/L,r[2]=.25*L),r}function zr(r,e,n,a){var i=e[0],t=e[1],s=e[2],c=e[3],f=i+i,v=t+t,x=s+s,m=i*f,h=i*v,M=i*x,l=t*v,p=t*x,d=s*x,b=c*f,w=c*v,T=c*x,E=a[0],o=a[1],R=a[2];return r[0]=(1-(l+d))*E,r[1]=(h+T)*E,r[2]=(M-w)*E,r[3]=0,r[4]=(h-T)*o,r[5]=(1-(m+d))*o,r[6]=(p+b)*o,r[7]=0,r[8]=(M+w)*R,r[9]=(p-b)*R,r[10]=(1-(m+l))*R,r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}function Fr(r,e,n,a,i){var t=e[0],s=e[1],c=e[2],f=e[3],v=t+t,x=s+s,m=c+c,h=t*v,M=t*x,l=t*m,p=s*x,d=s*m,b=c*m,w=f*v,T=f*x,E=f*m,o=a[0],R=a[1],y=a[2],A=i[0],P=i[1],L=i[2],S=(1-(p+b))*o,B=(M+E)*o,I=(l-T)*o,C=(M-E)*R,F=(1-(h+b))*R,N=(d+w)*R,O=(l+T)*y,Y=(d-w)*y,g=(1-(h+p))*y;return r[0]=S,r[1]=B,r[2]=I,r[3]=0,r[4]=C,r[5]=F,r[6]=N,r[7]=0,r[8]=O,r[9]=Y,r[10]=g,r[11]=0,r[12]=n[0]+A-(S*A+C*P+O*L),r[13]=n[1]+P-(B*A+F*P+Y*L),r[14]=n[2]+L-(I*A+N*P+g*L),r[15]=1,r}function Ur(r,e){var n=e[0],a=e[1],i=e[2],t=e[3],s=n+n,c=a+a,f=i+i,v=n*s,x=a*s,m=a*c,h=i*s,M=i*c,l=i*f,p=t*s,d=t*c,b=t*f;return r[0]=1-m-l,r[1]=x+b,r[2]=h-d,r[3]=0,r[4]=x-b,r[5]=1-v-l,r[6]=M+p,r[7]=0,r[8]=h+d,r[9]=M-p,r[10]=1-v-m,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function _r(r,e,n,a,i,t,s){var c=1/(n-e),f=1/(i-a),v=1/(t-s);return r[0]=t*2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t*2*f,r[6]=0,r[7]=0,r[8]=(n+e)*c,r[9]=(i+a)*f,r[10]=(s+t)*v,r[11]=-1,r[12]=0,r[13]=0,r[14]=s*t*2*v,r[15]=0,r}function j(r,e,n,a,i){var t=1/Math.tan(e/2);if(r[0]=t/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0){var s=1/(a-i);r[10]=(i+a)*s,r[14]=2*i*a*s}else r[10]=-1,r[14]=-2*a;return r}var Dr=j;function Nr(r,e,n,a,i){var t=1/Math.tan(e/2);if(r[0]=t/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0){var s=1/(a-i);r[10]=i*s,r[14]=i*a*s}else r[10]=-1,r[14]=-a;return r}function Or(r,e,n,a){var i=Math.tan(e.upDegrees*Math.PI/180),t=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),c=Math.tan(e.rightDegrees*Math.PI/180),f=2/(s+c),v=2/(i+t);return r[0]=f,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=v,r[6]=0,r[7]=0,r[8]=-((s-c)*f*.5),r[9]=(i-t)*v*.5,r[10]=a/(n-a),r[11]=-1,r[12]=0,r[13]=0,r[14]=a*n/(n-a),r[15]=0,r}function $(r,e,n,a,i,t,s){var c=1/(e-n),f=1/(a-i),v=1/(t-s);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*f,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*v,r[11]=0,r[12]=(e+n)*c,r[13]=(i+a)*f,r[14]=(s+t)*v,r[15]=1,r}var Gr=$;function Wr(r,e,n,a,i,t,s){var c=1/(e-n),f=1/(a-i),v=1/(t-s);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*f,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=v,r[11]=0,r[12]=(e+n)*c,r[13]=(i+a)*f,r[14]=t*v,r[15]=1,r}function Yr(r,e,n,a){var i,t,s,c,f,v,x,m,h,M,l=e[0],p=e[1],d=e[2],b=a[0],w=a[1],T=a[2],E=n[0],o=n[1],R=n[2];return Math.abs(l-E)<z&&Math.abs(p-o)<z&&Math.abs(d-R)<z?V(r):(x=l-E,m=p-o,h=d-R,M=1/Math.sqrt(x*x+m*m+h*h),x*=M,m*=M,h*=M,i=w*h-T*m,t=T*x-b*h,s=b*m-w*x,M=Math.sqrt(i*i+t*t+s*s),M?(M=1/M,i*=M,t*=M,s*=M):(i=0,t=0,s=0),c=m*s-h*t,f=h*i-x*s,v=x*t-m*i,M=Math.sqrt(c*c+f*f+v*v),M?(M=1/M,c*=M,f*=M,v*=M):(c=0,f=0,v=0),r[0]=i,r[1]=c,r[2]=x,r[3]=0,r[4]=t,r[5]=f,r[6]=m,r[7]=0,r[8]=s,r[9]=v,r[10]=h,r[11]=0,r[12]=-(i*l+t*p+s*d),r[13]=-(c*l+f*p+v*d),r[14]=-(x*l+m*p+h*d),r[15]=1,r)}function gr(r,e,n,a){var i=e[0],t=e[1],s=e[2],c=a[0],f=a[1],v=a[2],x=i-n[0],m=t-n[1],h=s-n[2],M=x*x+m*m+h*h;M>0&&(M=1/Math.sqrt(M),x*=M,m*=M,h*=M);var l=f*h-v*m,p=v*x-c*h,d=c*m-f*x;return M=l*l+p*p+d*d,M>0&&(M=1/Math.sqrt(M),l*=M,p*=M,d*=M),r[0]=l,r[1]=p,r[2]=d,r[3]=0,r[4]=m*d-h*p,r[5]=h*l-x*d,r[6]=x*p-m*l,r[7]=0,r[8]=x,r[9]=m,r[10]=h,r[11]=0,r[12]=i,r[13]=t,r[14]=s,r[15]=1,r}function Vr(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function Xr(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]+r[3]*r[3]+r[4]*r[4]+r[5]*r[5]+r[6]*r[6]+r[7]*r[7]+r[8]*r[8]+r[9]*r[9]+r[10]*r[10]+r[11]*r[11]+r[12]*r[12]+r[13]*r[13]+r[14]*r[14]+r[15]*r[15])}function qr(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r[4]=e[4]+n[4],r[5]=e[5]+n[5],r[6]=e[6]+n[6],r[7]=e[7]+n[7],r[8]=e[8]+n[8],r[9]=e[9]+n[9],r[10]=e[10]+n[10],r[11]=e[11]+n[11],r[12]=e[12]+n[12],r[13]=e[13]+n[13],r[14]=e[14]+n[14],r[15]=e[15]+n[15],r}function k(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r[4]=e[4]-n[4],r[5]=e[5]-n[5],r[6]=e[6]-n[6],r[7]=e[7]-n[7],r[8]=e[8]-n[8],r[9]=e[9]-n[9],r[10]=e[10]-n[10],r[11]=e[11]-n[11],r[12]=e[12]-n[12],r[13]=e[13]-n[13],r[14]=e[14]-n[14],r[15]=e[15]-n[15],r}function Hr(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[7]=e[7]*n,r[8]=e[8]*n,r[9]=e[9]*n,r[10]=e[10]*n,r[11]=e[11]*n,r[12]=e[12]*n,r[13]=e[13]*n,r[14]=e[14]*n,r[15]=e[15]*n,r}function jr(r,e,n,a){return r[0]=e[0]+n[0]*a,r[1]=e[1]+n[1]*a,r[2]=e[2]+n[2]*a,r[3]=e[3]+n[3]*a,r[4]=e[4]+n[4]*a,r[5]=e[5]+n[5]*a,r[6]=e[6]+n[6]*a,r[7]=e[7]+n[7]*a,r[8]=e[8]+n[8]*a,r[9]=e[9]+n[9]*a,r[10]=e[10]+n[10]*a,r[11]=e[11]+n[11]*a,r[12]=e[12]+n[12]*a,r[13]=e[13]+n[13]*a,r[14]=e[14]+n[14]*a,r[15]=e[15]+n[15]*a,r}function $r(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]}function kr(r,e){var n=r[0],a=r[1],i=r[2],t=r[3],s=r[4],c=r[5],f=r[6],v=r[7],x=r[8],m=r[9],h=r[10],M=r[11],l=r[12],p=r[13],d=r[14],b=r[15],w=e[0],T=e[1],E=e[2],o=e[3],R=e[4],y=e[5],A=e[6],P=e[7],L=e[8],S=e[9],B=e[10],I=e[11],C=e[12],F=e[13],N=e[14],O=e[15];return Math.abs(n-w)<=z*Math.max(1,Math.abs(n),Math.abs(w))&&Math.abs(a-T)<=z*Math.max(1,Math.abs(a),Math.abs(T))&&Math.abs(i-E)<=z*Math.max(1,Math.abs(i),Math.abs(E))&&Math.abs(t-o)<=z*Math.max(1,Math.abs(t),Math.abs(o))&&Math.abs(s-R)<=z*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(c-y)<=z*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(f-A)<=z*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(v-P)<=z*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(x-L)<=z*Math.max(1,Math.abs(x),Math.abs(L))&&Math.abs(m-S)<=z*Math.max(1,Math.abs(m),Math.abs(S))&&Math.abs(h-B)<=z*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(M-I)<=z*Math.max(1,Math.abs(M),Math.abs(I))&&Math.abs(l-C)<=z*Math.max(1,Math.abs(l),Math.abs(C))&&Math.abs(p-F)<=z*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(d-N)<=z*Math.max(1,Math.abs(d),Math.abs(N))&&Math.abs(b-O)<=z*Math.max(1,Math.abs(b),Math.abs(O))}var Zr=X,Kr=k;function Z(r,e,n,a,i){r.clearColor(1,1,1,1),r.clearDepth(1),r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT);let t=45*Math.PI/180;var s,c;r.canvas instanceof HTMLCanvasElement?(s=r.canvas.clientWidth,c=r.canvas.clientHeight):(s=r.canvas.width,c=r.canvas.height);let f=s/c,v=.1,x=100,m=U.create();U.perspective(m,t,f,v,x);let h=U.create();U.translate(h,h,[-0,0,-6]),U.rotate(h,h,i,[0,0,1]),U.rotate(h,h,i*.7,[0,1,0]),U.rotate(h,h,i*.3,[1,0,0]),Qr(r,n,e),Jr(r,n,e),ur(r,n,e),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n.indices),r.useProgram(e.program),r.uniformMatrix4fv(e.uniformLocations.projectionMatrix,!1,m),r.uniformMatrix4fv(e.uniformLocations.modelViewMatrix,!1,h),a&&(r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a),r.uniform1i(e.uniformLocations.uSampler,0));{let l=r.UNSIGNED_SHORT;r.drawElements(r.TRIANGLES,36,l,0)}}function Qr(r,e,n){let i=r.FLOAT,t=!1,s=0,c=0;r.bindBuffer(r.ARRAY_BUFFER,e.position),r.vertexAttribPointer(n.attribLocations.vertexPosition,3,i,t,s,c),r.enableVertexAttribArray(n.attribLocations.vertexPosition)}function Jr(r,e,n){let i=r.FLOAT,t=!1,s=0,c=0;r.bindBuffer(r.ARRAY_BUFFER,e.color),r.vertexAttribPointer(n.attribLocations.vertexColor,4,i,t,s,c),r.enableVertexAttribArray(n.attribLocations.vertexColor)}function ur(r,e,n){let i=r.FLOAT,t=!1,s=0,c=0;r.bindBuffer(r.ARRAY_BUFFER,e.textureCoord),r.vertexAttribPointer(n.attribLocations.textureCoord,2,i,t,s,c),r.enableVertexAttribArray(n.attribLocations.textureCoord)}function K(r){let e=r1(r);if(!e)throw Error("Failed to initialize position buffer");let n=e1(r);if(!n)throw Error("Failed to initialize color buffer");let a=n1(r);if(!a)throw Error("Failed to initialize texture buffer");let i=a1(r);if(!i)throw Error("Failed to initialize position buffer");return{position:e,color:n,textureCoord:a,indices:i}}function r1(r){let e=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,e);let n=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1];return r.bufferData(r.ARRAY_BUFFER,new Float32Array(n),r.STATIC_DRAW),e}function e1(r){let e=[[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]];var n=[],a;for(a=0;a<e.length;++a){let t=e[a];n=n.concat(t,t,t,t)}let i=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,i),r.bufferData(r.ARRAY_BUFFER,new Float32Array(n),r.STATIC_DRAW),i}function n1(r){let a=.3333333333333333,i=1/2,t=[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}],s=[];for(let f of t){let v=f.col*a,x=(f.col+1)*a,m=f.row*i,h=(f.row+1)*i;s.push(v,m,x,m,x,h,v,h)}let c=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,c),r.bufferData(r.ARRAY_BUFFER,new Float32Array(s),r.STATIC_DRAW),c}function a1(r){let e=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e);let n=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),r.STATIC_DRAW),e}var Q=0,J=0,G=[],D=null;async function i1(){try{let r=await fetch("/answers");if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return(await r.json()).answers||[]}catch(r){throw console.error("Failed to fetch answers:",r),r}}function t1(r,e,n){let a=e.split(/\s+/).filter(Boolean),i=[],t="";for(let s of a){let c=t?`${t} ${s}`:s;r.measureText(c).width>n&&t?(i.push(t),t=s):t=c}return t&&i.push(t),i.length?i:[e]}function s1(){let r=document.getElementById("hate-ball-canvas");if(!r){W("Canvas element not found.");return}let e=r.getContext("webgl");if(!e||e===null){W("Failed to get rendering context this is a bug :(");return}e.clearColor(1,1,1,1),e.clear(e.COLOR_BUFFER_BIT);let i=v1(e,`
        attribute vec4 aVertexPosition;
        attribute vec4 aVertexColor;
        attribute vec2 aTextureCoord;

        uniform mat4 uModelViewMatrix;
        uniform mat4 uProjectionMatrix;

        varying lowp vec4 vColor;
        varying highp vec2 vTextureCoord;

        void main(void) {
        gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;
        vColor = aVertexColor;
        vTextureCoord = aTextureCoord;
        }
    `,`
        varying lowp vec4 vColor;
        varying highp vec2 vTextureCoord;
        uniform sampler2D uSampler;

        void main(void) {
        gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;
        }
    `);if(!i)throw Error("Shader program failed to initialize.");let t={program:i,attribLocations:{vertexPosition:e.getAttribLocation(i,"aVertexPosition"),vertexColor:e.getAttribLocation(i,"aVertexColor"),textureCoord:e.getAttribLocation(i,"aTextureCoord")},uniformLocations:{projectionMatrix:e.getUniformLocation(i,"uProjectionMatrix"),modelViewMatrix:e.getUniformLocation(i,"uModelViewMatrix"),uSampler:e.getUniformLocation(i,"uSampler")}},s=K(e);D=c1(e),er(e,D,G);let c=0;function f(v,x){let m=v*.001;J=m-c,c=m,D?.needsUpdate&&nr(x,D),Z(x,t,s,D?.texture??null,Q),Q+=J,window.requestAnimationFrame(h=>f(h,x))}window.requestAnimationFrame(v=>f(v,e))}async function W(r){console.error(r);let e=document.getElementById("error");e&&(e.textContent=r,e.classList.remove("hidden"))}async function u(){let r=document.getElementById("error");try{let e=await i1();if(!e.length)W("No answers received from the server.");else{console.debug(`Received answers: ${e.join(" | ")}`),G=e;let n=document.getElementById("answer");n&&(n.textContent=G[0],n.classList.remove("hidden"));let i=document.getElementById("hate-ball-canvas")?.getContext("webgl");i&&D&&er(i,D,G),r&&r.classList.add("hidden")}}catch(e){W(`Error fetching answer: ${e}`)}}document.addEventListener("DOMContentLoaded",()=>{let r=document.getElementById("get_answer");r&&r.addEventListener("click",u),u(),s1()});function c1(r){let e=document.createElement("canvas");e.width=768,e.height=512;let n=e.getContext("2d");if(!n)throw new Error("Unable to create 2D context for text texture");let a=r.createTexture();if(!a)throw new Error("Unable to create WebGL texture");return r.bindTexture(r.TEXTURE_2D,a),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width,e.height,0,r.RGBA,r.UNSIGNED_BYTE,null),{texture:a,canvas:e,ctx:n,needsUpdate:!0}}function er(r,e,n){let{canvas:a,ctx:i}=e,t=3,s=2,c=a.width/t,f=a.height/s,v=20,x=["#111111","#d64b4b","#45b86f","#3d7dd8","#e0c24d","#b05bcf"],m=n.length?n:["..."];i.clearRect(0,0,a.width,a.height),i.textAlign="center",i.textBaseline="middle",i.font="bold 22px sans-serif";for(let h=0;h<t*s;h+=1){let M=h%t,l=Math.floor(h/t),p=M*c,d=l*f;i.fillStyle=x[h%x.length],i.fillRect(p,d,c,f);let b=m[h%m.length],w=c-v*2;i.fillStyle="#f7f3ea";let T=t1(i,b,w),E=26,o=p+c/2,y=d+f/2-(T.length-1)*E/2;for(let A=0;A<T.length;A+=1)i.fillText(T[A],o,y+A*E)}e.needsUpdate=!0,nr(r,e)}function nr(r,e){r.bindTexture(r.TEXTURE_2D,e.texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e.canvas),e.needsUpdate=!1}function v1(r,e,n){let a=rr(r,r.VERTEX_SHADER,e),i=rr(r,r.FRAGMENT_SHADER,n);if(!a||!i)throw new Error("Shader creation failed");let t=r.createProgram();return r.attachShader(t,a),r.attachShader(t,i),r.linkProgram(t),r.getProgramParameter(t,r.LINK_STATUS)?t:(alert(`Unable to initialize the shader program: ${r.getProgramInfoLog(t)}`),null)}function rr(r,e,n){let a=r.createShader(e);if(!a)throw new Error("Unable to create shader");return r.shaderSource(a,n),r.compileShader(a),r.getShaderParameter(a,r.COMPILE_STATUS)?a:(alert(`An error occurred compiling the shaders: ${r.getShaderInfoLog(a)}`),r.deleteShader(a),null)}
