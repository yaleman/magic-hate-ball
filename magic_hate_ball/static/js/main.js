var vr=Object.defineProperty;var fr=(r,e)=>{for(var n in e)vr(r,n,{get:e[n],enumerable:!0})};var I=1e-6,D=typeof Float32Array<"u"?Float32Array:Array;var Ee=Math.PI/180,Re=180/Math.PI;var _={};fr(_,{add:()=>Zr,adjoint:()=>Er,clone:()=>lr,copy:()=>dr,create:()=>hr,decompose:()=>Dr,determinant:()=>Rr,equals:()=>ur,exactEquals:()=>Jr,frob:()=>kr,fromQuat:()=>Or,fromQuat2:()=>Fr,fromRotation:()=>Sr,fromRotationTranslation:()=>Z,fromRotationTranslationScale:()=>Nr,fromRotationTranslationScaleOrigin:()=>Gr,fromScaling:()=>Pr,fromTranslation:()=>Cr,fromValues:()=>mr,fromXRotation:()=>zr,fromYRotation:()=>Br,fromZRotation:()=>Ir,frustum:()=>Wr,getRotation:()=>_r,getScaling:()=>K,getTranslation:()=>Ur,identity:()=>$,invert:()=>pr,lookAt:()=>qr,mul:()=>re,multiply:()=>k,multiplyScalar:()=>Kr,multiplyScalarAndAdd:()=>Qr,ortho:()=>Hr,orthoNO:()=>J,orthoZO:()=>Xr,perspective:()=>gr,perspectiveFromFieldOfView:()=>Vr,perspectiveNO:()=>Q,perspectiveZO:()=>Yr,rotate:()=>wr,rotateX:()=>yr,rotateY:()=>Lr,rotateZ:()=>Ar,scale:()=>Tr,set:()=>Mr,str:()=>$r,sub:()=>ee,subtract:()=>u,targetTo:()=>jr,translate:()=>br,transpose:()=>or});function hr(){var r=new D(16);return D!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r}function lr(r){var e=new D(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e}function dr(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function mr(r,e,n,a,i,t,s,c,f,v,x,l,d,m,M,o){var h=new D(16);return h[0]=r,h[1]=e,h[2]=n,h[3]=a,h[4]=i,h[5]=t,h[6]=s,h[7]=c,h[8]=f,h[9]=v,h[10]=x,h[11]=l,h[12]=d,h[13]=m,h[14]=M,h[15]=o,h}function Mr(r,e,n,a,i,t,s,c,f,v,x,l,d,m,M,o,h){return r[0]=e,r[1]=n,r[2]=a,r[3]=i,r[4]=t,r[5]=s,r[6]=c,r[7]=f,r[8]=v,r[9]=x,r[10]=l,r[11]=d,r[12]=m,r[13]=M,r[14]=o,r[15]=h,r}function $(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function or(r,e){if(r===e){var n=e[1],a=e[2],i=e[3],t=e[6],s=e[7],c=e[11];r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=n,r[6]=e[9],r[7]=e[13],r[8]=a,r[9]=t,r[11]=e[14],r[12]=i,r[13]=s,r[14]=c}else r[0]=e[0],r[1]=e[4],r[2]=e[8],r[3]=e[12],r[4]=e[1],r[5]=e[5],r[6]=e[9],r[7]=e[13],r[8]=e[2],r[9]=e[6],r[10]=e[10],r[11]=e[14],r[12]=e[3],r[13]=e[7],r[14]=e[11],r[15]=e[15];return r}function pr(r,e){var n=e[0],a=e[1],i=e[2],t=e[3],s=e[4],c=e[5],f=e[6],v=e[7],x=e[8],l=e[9],d=e[10],m=e[11],M=e[12],o=e[13],h=e[14],T=e[15],y=n*c-a*s,b=n*f-i*s,p=n*v-t*s,E=a*f-i*c,R=a*v-t*c,A=i*v-t*f,L=x*o-l*M,P=x*h-d*M,w=x*T-m*M,S=l*h-d*o,z=l*T-m*o,B=d*T-m*h,C=y*B-b*z+p*S+E*w-R*P+A*L;return C?(C=1/C,r[0]=(c*B-f*z+v*S)*C,r[1]=(i*z-a*B-t*S)*C,r[2]=(o*A-h*R+T*E)*C,r[3]=(d*R-l*A-m*E)*C,r[4]=(f*w-s*B-v*P)*C,r[5]=(n*B-i*w+t*P)*C,r[6]=(h*p-M*A-T*b)*C,r[7]=(x*A-d*p+m*b)*C,r[8]=(s*z-c*w+v*L)*C,r[9]=(a*w-n*z-t*L)*C,r[10]=(M*R-o*p+T*y)*C,r[11]=(l*p-x*R-m*y)*C,r[12]=(c*P-s*S-f*L)*C,r[13]=(n*S-a*P+i*L)*C,r[14]=(o*b-M*E-h*y)*C,r[15]=(x*E-l*b+d*y)*C,r):null}function Er(r,e){var n=e[0],a=e[1],i=e[2],t=e[3],s=e[4],c=e[5],f=e[6],v=e[7],x=e[8],l=e[9],d=e[10],m=e[11],M=e[12],o=e[13],h=e[14],T=e[15],y=n*c-a*s,b=n*f-i*s,p=n*v-t*s,E=a*f-i*c,R=a*v-t*c,A=i*v-t*f,L=x*o-l*M,P=x*h-d*M,w=x*T-m*M,S=l*h-d*o,z=l*T-m*o,B=d*T-m*h;return r[0]=c*B-f*z+v*S,r[1]=i*z-a*B-t*S,r[2]=o*A-h*R+T*E,r[3]=d*R-l*A-m*E,r[4]=f*w-s*B-v*P,r[5]=n*B-i*w+t*P,r[6]=h*p-M*A-T*b,r[7]=x*A-d*p+m*b,r[8]=s*z-c*w+v*L,r[9]=a*w-n*z-t*L,r[10]=M*R-o*p+T*y,r[11]=l*p-x*R-m*y,r[12]=c*P-s*S-f*L,r[13]=n*S-a*P+i*L,r[14]=o*b-M*E-h*y,r[15]=x*E-l*b+d*y,r}function Rr(r){var e=r[0],n=r[1],a=r[2],i=r[3],t=r[4],s=r[5],c=r[6],f=r[7],v=r[8],x=r[9],l=r[10],d=r[11],m=r[12],M=r[13],o=r[14],h=r[15],T=e*s-n*t,y=e*c-a*t,b=n*c-a*s,p=v*M-x*m,E=v*o-l*m,R=x*o-l*M,A=e*R-n*E+a*p,L=t*R-s*E+c*p,P=v*b-x*y+l*T,w=m*b-M*y+o*T;return f*A-i*L+h*P-d*w}function k(r,e,n){var a=e[0],i=e[1],t=e[2],s=e[3],c=e[4],f=e[5],v=e[6],x=e[7],l=e[8],d=e[9],m=e[10],M=e[11],o=e[12],h=e[13],T=e[14],y=e[15],b=n[0],p=n[1],E=n[2],R=n[3];return r[0]=b*a+p*c+E*l+R*o,r[1]=b*i+p*f+E*d+R*h,r[2]=b*t+p*v+E*m+R*T,r[3]=b*s+p*x+E*M+R*y,b=n[4],p=n[5],E=n[6],R=n[7],r[4]=b*a+p*c+E*l+R*o,r[5]=b*i+p*f+E*d+R*h,r[6]=b*t+p*v+E*m+R*T,r[7]=b*s+p*x+E*M+R*y,b=n[8],p=n[9],E=n[10],R=n[11],r[8]=b*a+p*c+E*l+R*o,r[9]=b*i+p*f+E*d+R*h,r[10]=b*t+p*v+E*m+R*T,r[11]=b*s+p*x+E*M+R*y,b=n[12],p=n[13],E=n[14],R=n[15],r[12]=b*a+p*c+E*l+R*o,r[13]=b*i+p*f+E*d+R*h,r[14]=b*t+p*v+E*m+R*T,r[15]=b*s+p*x+E*M+R*y,r}function br(r,e,n){var a=n[0],i=n[1],t=n[2],s,c,f,v,x,l,d,m,M,o,h,T;return e===r?(r[12]=e[0]*a+e[4]*i+e[8]*t+e[12],r[13]=e[1]*a+e[5]*i+e[9]*t+e[13],r[14]=e[2]*a+e[6]*i+e[10]*t+e[14],r[15]=e[3]*a+e[7]*i+e[11]*t+e[15]):(s=e[0],c=e[1],f=e[2],v=e[3],x=e[4],l=e[5],d=e[6],m=e[7],M=e[8],o=e[9],h=e[10],T=e[11],r[0]=s,r[1]=c,r[2]=f,r[3]=v,r[4]=x,r[5]=l,r[6]=d,r[7]=m,r[8]=M,r[9]=o,r[10]=h,r[11]=T,r[12]=s*a+x*i+M*t+e[12],r[13]=c*a+l*i+o*t+e[13],r[14]=f*a+d*i+h*t+e[14],r[15]=v*a+m*i+T*t+e[15]),r}function Tr(r,e,n){var a=n[0],i=n[1],t=n[2];return r[0]=e[0]*a,r[1]=e[1]*a,r[2]=e[2]*a,r[3]=e[3]*a,r[4]=e[4]*i,r[5]=e[5]*i,r[6]=e[6]*i,r[7]=e[7]*i,r[8]=e[8]*t,r[9]=e[9]*t,r[10]=e[10]*t,r[11]=e[11]*t,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function wr(r,e,n,a){var i=a[0],t=a[1],s=a[2],c=Math.sqrt(i*i+t*t+s*s),f,v,x,l,d,m,M,o,h,T,y,b,p,E,R,A,L,P,w,S,z,B,C,F;return c<I?null:(c=1/c,i*=c,t*=c,s*=c,f=Math.sin(n),v=Math.cos(n),x=1-v,l=e[0],d=e[1],m=e[2],M=e[3],o=e[4],h=e[5],T=e[6],y=e[7],b=e[8],p=e[9],E=e[10],R=e[11],A=i*i*x+v,L=t*i*x+s*f,P=s*i*x-t*f,w=i*t*x-s*f,S=t*t*x+v,z=s*t*x+i*f,B=i*s*x+t*f,C=t*s*x-i*f,F=s*s*x+v,r[0]=l*A+o*L+b*P,r[1]=d*A+h*L+p*P,r[2]=m*A+T*L+E*P,r[3]=M*A+y*L+R*P,r[4]=l*w+o*S+b*z,r[5]=d*w+h*S+p*z,r[6]=m*w+T*S+E*z,r[7]=M*w+y*S+R*z,r[8]=l*B+o*C+b*F,r[9]=d*B+h*C+p*F,r[10]=m*B+T*C+E*F,r[11]=M*B+y*C+R*F,e!==r&&(r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r)}function yr(r,e,n){var a=Math.sin(n),i=Math.cos(n),t=e[4],s=e[5],c=e[6],f=e[7],v=e[8],x=e[9],l=e[10],d=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=t*i+v*a,r[5]=s*i+x*a,r[6]=c*i+l*a,r[7]=f*i+d*a,r[8]=v*i-t*a,r[9]=x*i-s*a,r[10]=l*i-c*a,r[11]=d*i-f*a,r}function Lr(r,e,n){var a=Math.sin(n),i=Math.cos(n),t=e[0],s=e[1],c=e[2],f=e[3],v=e[8],x=e[9],l=e[10],d=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=t*i-v*a,r[1]=s*i-x*a,r[2]=c*i-l*a,r[3]=f*i-d*a,r[8]=t*a+v*i,r[9]=s*a+x*i,r[10]=c*a+l*i,r[11]=f*a+d*i,r}function Ar(r,e,n){var a=Math.sin(n),i=Math.cos(n),t=e[0],s=e[1],c=e[2],f=e[3],v=e[4],x=e[5],l=e[6],d=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=t*i+v*a,r[1]=s*i+x*a,r[2]=c*i+l*a,r[3]=f*i+d*a,r[4]=v*i-t*a,r[5]=x*i-s*a,r[6]=l*i-c*a,r[7]=d*i-f*a,r}function Cr(r,e){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r}function Pr(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Sr(r,e,n){var a=n[0],i=n[1],t=n[2],s=Math.sqrt(a*a+i*i+t*t),c,f,v;return s<I?null:(s=1/s,a*=s,i*=s,t*=s,c=Math.sin(e),f=Math.cos(e),v=1-f,r[0]=a*a*v+f,r[1]=i*a*v+t*c,r[2]=t*a*v-i*c,r[3]=0,r[4]=a*i*v-t*c,r[5]=i*i*v+f,r[6]=t*i*v+a*c,r[7]=0,r[8]=a*t*v+i*c,r[9]=i*t*v-a*c,r[10]=t*t*v+f,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}function zr(r,e){var n=Math.sin(e),a=Math.cos(e);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=n,r[7]=0,r[8]=0,r[9]=-n,r[10]=a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Br(r,e){var n=Math.sin(e),a=Math.cos(e);return r[0]=a,r[1]=0,r[2]=-n,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=n,r[9]=0,r[10]=a,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Ir(r,e){var n=Math.sin(e),a=Math.cos(e);return r[0]=a,r[1]=n,r[2]=0,r[3]=0,r[4]=-n,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Z(r,e,n){var a=e[0],i=e[1],t=e[2],s=e[3],c=a+a,f=i+i,v=t+t,x=a*c,l=a*f,d=a*v,m=i*f,M=i*v,o=t*v,h=s*c,T=s*f,y=s*v;return r[0]=1-(m+o),r[1]=l+y,r[2]=d-T,r[3]=0,r[4]=l-y,r[5]=1-(x+o),r[6]=M+h,r[7]=0,r[8]=d+T,r[9]=M-h,r[10]=1-(x+m),r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}function Fr(r,e){var n=new D(3),a=-e[0],i=-e[1],t=-e[2],s=e[3],c=e[4],f=e[5],v=e[6],x=e[7],l=a*a+i*i+t*t+s*s;return l>0?(n[0]=(c*s+x*a+f*t-v*i)*2/l,n[1]=(f*s+x*i+v*a-c*t)*2/l,n[2]=(v*s+x*t+c*i-f*a)*2/l):(n[0]=(c*s+x*a+f*t-v*i)*2,n[1]=(f*s+x*i+v*a-c*t)*2,n[2]=(v*s+x*t+c*i-f*a)*2),Z(r,e,n),r}function Ur(r,e){return r[0]=e[12],r[1]=e[13],r[2]=e[14],r}function K(r,e){var n=e[0],a=e[1],i=e[2],t=e[4],s=e[5],c=e[6],f=e[8],v=e[9],x=e[10];return r[0]=Math.sqrt(n*n+a*a+i*i),r[1]=Math.sqrt(t*t+s*s+c*c),r[2]=Math.sqrt(f*f+v*v+x*x),r}function _r(r,e){var n=new D(3);K(n,e);var a=1/n[0],i=1/n[1],t=1/n[2],s=e[0]*a,c=e[1]*i,f=e[2]*t,v=e[4]*a,x=e[5]*i,l=e[6]*t,d=e[8]*a,m=e[9]*i,M=e[10]*t,o=s+x+M,h=0;return o>0?(h=Math.sqrt(o+1)*2,r[3]=.25*h,r[0]=(l-m)/h,r[1]=(d-f)/h,r[2]=(c-v)/h):s>x&&s>M?(h=Math.sqrt(1+s-x-M)*2,r[3]=(l-m)/h,r[0]=.25*h,r[1]=(c+v)/h,r[2]=(d+f)/h):x>M?(h=Math.sqrt(1+x-s-M)*2,r[3]=(d-f)/h,r[0]=(c+v)/h,r[1]=.25*h,r[2]=(l+m)/h):(h=Math.sqrt(1+M-s-x)*2,r[3]=(c-v)/h,r[0]=(d+f)/h,r[1]=(l+m)/h,r[2]=.25*h),r}function Dr(r,e,n,a){e[0]=a[12],e[1]=a[13],e[2]=a[14];var i=a[0],t=a[1],s=a[2],c=a[4],f=a[5],v=a[6],x=a[8],l=a[9],d=a[10];n[0]=Math.sqrt(i*i+t*t+s*s),n[1]=Math.sqrt(c*c+f*f+v*v),n[2]=Math.sqrt(x*x+l*l+d*d);var m=1/n[0],M=1/n[1],o=1/n[2],h=i*m,T=t*M,y=s*o,b=c*m,p=f*M,E=v*o,R=x*m,A=l*M,L=d*o,P=h+p+L,w=0;return P>0?(w=Math.sqrt(P+1)*2,r[3]=.25*w,r[0]=(E-A)/w,r[1]=(R-y)/w,r[2]=(T-b)/w):h>p&&h>L?(w=Math.sqrt(1+h-p-L)*2,r[3]=(E-A)/w,r[0]=.25*w,r[1]=(T+b)/w,r[2]=(R+y)/w):p>L?(w=Math.sqrt(1+p-h-L)*2,r[3]=(R-y)/w,r[0]=(T+b)/w,r[1]=.25*w,r[2]=(E+A)/w):(w=Math.sqrt(1+L-h-p)*2,r[3]=(T-b)/w,r[0]=(R+y)/w,r[1]=(E+A)/w,r[2]=.25*w),r}function Nr(r,e,n,a){var i=e[0],t=e[1],s=e[2],c=e[3],f=i+i,v=t+t,x=s+s,l=i*f,d=i*v,m=i*x,M=t*v,o=t*x,h=s*x,T=c*f,y=c*v,b=c*x,p=a[0],E=a[1],R=a[2];return r[0]=(1-(M+h))*p,r[1]=(d+b)*p,r[2]=(m-y)*p,r[3]=0,r[4]=(d-b)*E,r[5]=(1-(l+h))*E,r[6]=(o+T)*E,r[7]=0,r[8]=(m+y)*R,r[9]=(o-T)*R,r[10]=(1-(l+M))*R,r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r}function Gr(r,e,n,a,i){var t=e[0],s=e[1],c=e[2],f=e[3],v=t+t,x=s+s,l=c+c,d=t*v,m=t*x,M=t*l,o=s*x,h=s*l,T=c*l,y=f*v,b=f*x,p=f*l,E=a[0],R=a[1],A=a[2],L=i[0],P=i[1],w=i[2],S=(1-(o+T))*E,z=(m+p)*E,B=(M-b)*E,C=(m-p)*R,F=(1-(d+T))*R,U=(h+y)*R,G=(M+b)*A,q=(h-y)*A,j=(1-(d+o))*A;return r[0]=S,r[1]=z,r[2]=B,r[3]=0,r[4]=C,r[5]=F,r[6]=U,r[7]=0,r[8]=G,r[9]=q,r[10]=j,r[11]=0,r[12]=n[0]+L-(S*L+C*P+G*w),r[13]=n[1]+P-(z*L+F*P+q*w),r[14]=n[2]+w-(B*L+U*P+j*w),r[15]=1,r}function Or(r,e){var n=e[0],a=e[1],i=e[2],t=e[3],s=n+n,c=a+a,f=i+i,v=n*s,x=a*s,l=a*c,d=i*s,m=i*c,M=i*f,o=t*s,h=t*c,T=t*f;return r[0]=1-l-M,r[1]=x+T,r[2]=d-h,r[3]=0,r[4]=x-T,r[5]=1-v-M,r[6]=m+o,r[7]=0,r[8]=d+h,r[9]=m-o,r[10]=1-v-l,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function Wr(r,e,n,a,i,t,s){var c=1/(n-e),f=1/(i-a),v=1/(t-s);return r[0]=t*2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t*2*f,r[6]=0,r[7]=0,r[8]=(n+e)*c,r[9]=(i+a)*f,r[10]=(s+t)*v,r[11]=-1,r[12]=0,r[13]=0,r[14]=s*t*2*v,r[15]=0,r}function Q(r,e,n,a,i){var t=1/Math.tan(e/2);if(r[0]=t/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0){var s=1/(a-i);r[10]=(i+a)*s,r[14]=2*i*a*s}else r[10]=-1,r[14]=-2*a;return r}var gr=Q;function Yr(r,e,n,a,i){var t=1/Math.tan(e/2);if(r[0]=t/n,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=t,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,i!=null&&i!==1/0){var s=1/(a-i);r[10]=i*s,r[14]=i*a*s}else r[10]=-1,r[14]=-a;return r}function Vr(r,e,n,a){var i=Math.tan(e.upDegrees*Math.PI/180),t=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),c=Math.tan(e.rightDegrees*Math.PI/180),f=2/(s+c),v=2/(i+t);return r[0]=f,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=v,r[6]=0,r[7]=0,r[8]=-((s-c)*f*.5),r[9]=(i-t)*v*.5,r[10]=a/(n-a),r[11]=-1,r[12]=0,r[13]=0,r[14]=a*n/(n-a),r[15]=0,r}function J(r,e,n,a,i,t,s){var c=1/(e-n),f=1/(a-i),v=1/(t-s);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*f,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*v,r[11]=0,r[12]=(e+n)*c,r[13]=(i+a)*f,r[14]=(s+t)*v,r[15]=1,r}var Hr=J;function Xr(r,e,n,a,i,t,s){var c=1/(e-n),f=1/(a-i),v=1/(t-s);return r[0]=-2*c,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*f,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=v,r[11]=0,r[12]=(e+n)*c,r[13]=(i+a)*f,r[14]=t*v,r[15]=1,r}function qr(r,e,n,a){var i,t,s,c,f,v,x,l,d,m,M=e[0],o=e[1],h=e[2],T=a[0],y=a[1],b=a[2],p=n[0],E=n[1],R=n[2];return Math.abs(M-p)<I&&Math.abs(o-E)<I&&Math.abs(h-R)<I?$(r):(x=M-p,l=o-E,d=h-R,m=1/Math.sqrt(x*x+l*l+d*d),x*=m,l*=m,d*=m,i=y*d-b*l,t=b*x-T*d,s=T*l-y*x,m=Math.sqrt(i*i+t*t+s*s),m?(m=1/m,i*=m,t*=m,s*=m):(i=0,t=0,s=0),c=l*s-d*t,f=d*i-x*s,v=x*t-l*i,m=Math.sqrt(c*c+f*f+v*v),m?(m=1/m,c*=m,f*=m,v*=m):(c=0,f=0,v=0),r[0]=i,r[1]=c,r[2]=x,r[3]=0,r[4]=t,r[5]=f,r[6]=l,r[7]=0,r[8]=s,r[9]=v,r[10]=d,r[11]=0,r[12]=-(i*M+t*o+s*h),r[13]=-(c*M+f*o+v*h),r[14]=-(x*M+l*o+d*h),r[15]=1,r)}function jr(r,e,n,a){var i=e[0],t=e[1],s=e[2],c=a[0],f=a[1],v=a[2],x=i-n[0],l=t-n[1],d=s-n[2],m=x*x+l*l+d*d;m>0&&(m=1/Math.sqrt(m),x*=m,l*=m,d*=m);var M=f*d-v*l,o=v*x-c*d,h=c*l-f*x;return m=M*M+o*o+h*h,m>0&&(m=1/Math.sqrt(m),M*=m,o*=m,h*=m),r[0]=M,r[1]=o,r[2]=h,r[3]=0,r[4]=l*h-d*o,r[5]=d*M-x*h,r[6]=x*o-l*M,r[7]=0,r[8]=x,r[9]=l,r[10]=d,r[11]=0,r[12]=i,r[13]=t,r[14]=s,r[15]=1,r}function $r(r){return"mat4("+r[0]+", "+r[1]+", "+r[2]+", "+r[3]+", "+r[4]+", "+r[5]+", "+r[6]+", "+r[7]+", "+r[8]+", "+r[9]+", "+r[10]+", "+r[11]+", "+r[12]+", "+r[13]+", "+r[14]+", "+r[15]+")"}function kr(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]+r[3]*r[3]+r[4]*r[4]+r[5]*r[5]+r[6]*r[6]+r[7]*r[7]+r[8]*r[8]+r[9]*r[9]+r[10]*r[10]+r[11]*r[11]+r[12]*r[12]+r[13]*r[13]+r[14]*r[14]+r[15]*r[15])}function Zr(r,e,n){return r[0]=e[0]+n[0],r[1]=e[1]+n[1],r[2]=e[2]+n[2],r[3]=e[3]+n[3],r[4]=e[4]+n[4],r[5]=e[5]+n[5],r[6]=e[6]+n[6],r[7]=e[7]+n[7],r[8]=e[8]+n[8],r[9]=e[9]+n[9],r[10]=e[10]+n[10],r[11]=e[11]+n[11],r[12]=e[12]+n[12],r[13]=e[13]+n[13],r[14]=e[14]+n[14],r[15]=e[15]+n[15],r}function u(r,e,n){return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],r[3]=e[3]-n[3],r[4]=e[4]-n[4],r[5]=e[5]-n[5],r[6]=e[6]-n[6],r[7]=e[7]-n[7],r[8]=e[8]-n[8],r[9]=e[9]-n[9],r[10]=e[10]-n[10],r[11]=e[11]-n[11],r[12]=e[12]-n[12],r[13]=e[13]-n[13],r[14]=e[14]-n[14],r[15]=e[15]-n[15],r}function Kr(r,e,n){return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*n,r[5]=e[5]*n,r[6]=e[6]*n,r[7]=e[7]*n,r[8]=e[8]*n,r[9]=e[9]*n,r[10]=e[10]*n,r[11]=e[11]*n,r[12]=e[12]*n,r[13]=e[13]*n,r[14]=e[14]*n,r[15]=e[15]*n,r}function Qr(r,e,n,a){return r[0]=e[0]+n[0]*a,r[1]=e[1]+n[1]*a,r[2]=e[2]+n[2]*a,r[3]=e[3]+n[3]*a,r[4]=e[4]+n[4]*a,r[5]=e[5]+n[5]*a,r[6]=e[6]+n[6]*a,r[7]=e[7]+n[7]*a,r[8]=e[8]+n[8]*a,r[9]=e[9]+n[9]*a,r[10]=e[10]+n[10]*a,r[11]=e[11]+n[11]*a,r[12]=e[12]+n[12]*a,r[13]=e[13]+n[13]*a,r[14]=e[14]+n[14]*a,r[15]=e[15]+n[15]*a,r}function Jr(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]&&r[4]===e[4]&&r[5]===e[5]&&r[6]===e[6]&&r[7]===e[7]&&r[8]===e[8]&&r[9]===e[9]&&r[10]===e[10]&&r[11]===e[11]&&r[12]===e[12]&&r[13]===e[13]&&r[14]===e[14]&&r[15]===e[15]}function ur(r,e){var n=r[0],a=r[1],i=r[2],t=r[3],s=r[4],c=r[5],f=r[6],v=r[7],x=r[8],l=r[9],d=r[10],m=r[11],M=r[12],o=r[13],h=r[14],T=r[15],y=e[0],b=e[1],p=e[2],E=e[3],R=e[4],A=e[5],L=e[6],P=e[7],w=e[8],S=e[9],z=e[10],B=e[11],C=e[12],F=e[13],U=e[14],G=e[15];return Math.abs(n-y)<=I*Math.max(1,Math.abs(n),Math.abs(y))&&Math.abs(a-b)<=I*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(i-p)<=I*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(t-E)<=I*Math.max(1,Math.abs(t),Math.abs(E))&&Math.abs(s-R)<=I*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(c-A)<=I*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(f-L)<=I*Math.max(1,Math.abs(f),Math.abs(L))&&Math.abs(v-P)<=I*Math.max(1,Math.abs(v),Math.abs(P))&&Math.abs(x-w)<=I*Math.max(1,Math.abs(x),Math.abs(w))&&Math.abs(l-S)<=I*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(d-z)<=I*Math.max(1,Math.abs(d),Math.abs(z))&&Math.abs(m-B)<=I*Math.max(1,Math.abs(m),Math.abs(B))&&Math.abs(M-C)<=I*Math.max(1,Math.abs(M),Math.abs(C))&&Math.abs(o-F)<=I*Math.max(1,Math.abs(o),Math.abs(F))&&Math.abs(h-U)<=I*Math.max(1,Math.abs(h),Math.abs(U))&&Math.abs(T-G)<=I*Math.max(1,Math.abs(T),Math.abs(G))}var re=k,ee=u;function rr(r,e,n,a,i){r.clearColor(0,0,0,1),r.clearDepth(1),r.enable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT);let t=45*Math.PI/180;var s,c;r.canvas instanceof HTMLCanvasElement?(s=r.canvas.clientWidth,c=r.canvas.clientHeight):(s=r.canvas.width,c=r.canvas.height);let f=s/c,v=.1,x=100,l=_.create();_.perspective(l,t,f,v,x);let d=_.create();_.translate(d,d,[-0,0,-6]),_.rotate(d,d,i.z,[0,0,1]),_.rotate(d,d,i.y,[0,1,0]),_.rotate(d,d,i.x,[1,0,0]),ne(r,n,e),ae(r,n,e),ie(r,n,e),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,n.indices),r.useProgram(e.program),r.uniformMatrix4fv(e.uniformLocations.projectionMatrix,!1,l),r.uniformMatrix4fv(e.uniformLocations.modelViewMatrix,!1,d),a&&(r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,a),r.uniform1i(e.uniformLocations.uSampler,0));{let M=r.UNSIGNED_SHORT;r.drawElements(r.TRIANGLES,36,M,0)}}function ne(r,e,n){let i=r.FLOAT,t=!1,s=0,c=0;r.bindBuffer(r.ARRAY_BUFFER,e.position),r.vertexAttribPointer(n.attribLocations.vertexPosition,3,i,t,s,c),r.enableVertexAttribArray(n.attribLocations.vertexPosition)}function ae(r,e,n){let i=r.FLOAT,t=!1,s=0,c=0;r.bindBuffer(r.ARRAY_BUFFER,e.color),r.vertexAttribPointer(n.attribLocations.vertexColor,4,i,t,s,c),r.enableVertexAttribArray(n.attribLocations.vertexColor)}function ie(r,e,n){let i=r.FLOAT,t=!1,s=0,c=0;r.bindBuffer(r.ARRAY_BUFFER,e.textureCoord),r.vertexAttribPointer(n.attribLocations.textureCoord,2,i,t,s,c),r.enableVertexAttribArray(n.attribLocations.textureCoord)}function er(r){let e=te(r);if(!e)throw Error("Failed to initialize position buffer");let n=se(r);if(!n)throw Error("Failed to initialize color buffer");let a=ce(r);if(!a)throw Error("Failed to initialize texture buffer");let i=ve(r);if(!i)throw Error("Failed to initialize position buffer");return{position:e,color:n,textureCoord:a,indices:i}}function te(r){let e=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,e);let n=[-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1];return r.bufferData(r.ARRAY_BUFFER,new Float32Array(n),r.STATIC_DRAW),e}function se(r){let e=[[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]];var n=[],a;for(a=0;a<e.length;++a){let t=e[a];n=n.concat(t,t,t,t)}let i=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,i),r.bufferData(r.ARRAY_BUFFER,new Float32Array(n),r.STATIC_DRAW),i}function ce(r){let a=.3333333333333333,i=1/2,t=[{col:0,row:0},{col:1,row:0},{col:2,row:0},{col:0,row:1},{col:1,row:1},{col:2,row:1}],s=[];for(let f of t){let v=f.col*a,x=(f.col+1)*a,l=f.row*i,d=(f.row+1)*i;s.push(v,l,x,l,x,d,v,d)}let c=r.createBuffer();return r.bindBuffer(r.ARRAY_BUFFER,c),r.bufferData(r.ARRAY_BUFFER,new Float32Array(s),r.STATIC_DRAW),c}function ve(r){let e=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e);let n=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23];return r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),r.STATIC_DRAW),e}var X=[],N=null,Y={x:0,y:0,z:0},O={x:0,y:0,z:0},W={x:0,y:0,z:0},g=null,fe=1e3;async function xe(){try{let r=await fetch("/answers");if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return(await r.json()).answers||[]}catch(r){throw console.error("Failed to fetch answers:",r),r}}function he(r,e,n){let a=e.split(/\s+/).filter(Boolean),i=[],t="";for(let s of a){let c=t?`${t} ${s}`:s;r.measureText(c).width>n&&t?(i.push(t),t=s):t=c}return t&&i.push(t),i.length?i:[e]}function nr(r,e){let n=r.getBoundingClientRect(),a=Math.max(1,Math.round(Math.min(n.width,n.height))),i=a,t=a,s=window.devicePixelRatio||1,c=Math.round(i*s),f=Math.round(t*s);(r.width!==c||r.height!==f)&&(r.width=c,r.height=f,e.viewport(0,0,r.width,r.height))}function le(r,e){let n=null,a=()=>{n!==null&&window.clearTimeout(n),n=window.setTimeout(()=>{nr(r,e),n=null},100)};window.addEventListener("resize",a),nr(r,e)}function de(){let r=document.getElementById("hate-ball-canvas");if(!r){V("Canvas element not found.");return}let e=r.getContext("webgl");if(!e||e===null){V("Failed to get rendering context this is a bug :(");return}le(r,e),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT);let i=oe(e,`
        attribute vec4 aVertexPosition;
        attribute vec4 aVertexColor;
        attribute vec2 aTextureCoord;

        uniform mat4 uModelViewMatrix;
        uniform mat4 uProjectionMatrix;

        varying lowp vec4 vColor;
        varying highp vec2 vTextureCoord;

        void main(void) {
        gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;
        vColor = aVertexColor;
        vTextureCoord = aTextureCoord;
        }
    `,`
        varying lowp vec4 vColor;
        varying highp vec2 vTextureCoord;
        uniform sampler2D uSampler;

        void main(void) {
        gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;
        }
    `);if(!i)throw Error("Shader program failed to initialize.");let t={program:i,attribLocations:{vertexPosition:e.getAttribLocation(i,"aVertexPosition"),vertexColor:e.getAttribLocation(i,"aVertexColor"),textureCoord:e.getAttribLocation(i,"aTextureCoord")},uniformLocations:{projectionMatrix:e.getUniformLocation(i,"uProjectionMatrix"),modelViewMatrix:e.getUniformLocation(i,"uModelViewMatrix"),uSampler:e.getUniformLocation(i,"uSampler")}},s=er(e);N=Me(e),sr(e,N,X),tr();function c(f,v){me(f),N?.needsUpdate&&cr(v,N),rr(v,t,s,N?.texture??null,Y),window.requestAnimationFrame(x=>c(x,v))}window.requestAnimationFrame(f=>c(f,e))}async function V(r){console.error(r);let e=document.getElementById("error");e&&(e.textContent=r,e.classList.remove("hidden"))}async function ar(){let r=document.getElementById("error");try{let e=await xe();if(!e.length)V("No answers received from the server.");else{console.debug(`Received answers: ${e.join(" | ")}`),X=e;let a=document.getElementById("hate-ball-canvas")?.getContext("webgl");a&&N&&sr(a,N,X),tr(),r&&r.classList.add("hidden")}}catch(e){V(`Error fetching answer: ${e}`)}}function tr(){O={x:Math.random()*Math.PI*2,y:Math.random()*Math.PI*2,z:Math.random()*Math.PI*2},Y={...O},g=performance.now()}function me(r){if(g===null)return;let e=(r-g)/fe;if(e>=1){Y={...W},g=null;return}let n=1-(1-e)**3;Y={x:H(O.x,W.x,n),y:H(O.y,W.y,n),z:H(O.z,W.z,n)}}function H(r,e,n){return r+(e-r)*n}function Me(r){let e=document.createElement("canvas");e.width=2048,e.height=1365;let n=e.getContext("2d");if(!n)throw new Error("Unable to create 2D context for text texture");let a=r.createTexture();if(!a)throw new Error("Unable to create WebGL texture");return r.bindTexture(r.TEXTURE_2D,a),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width,e.height,0,r.RGBA,r.UNSIGNED_BYTE,null),{texture:a,canvas:e,ctx:n,needsUpdate:!0}}function sr(r,e,n){let{canvas:a,ctx:i}=e,t=3,s=2,c=a.width/t,f=a.height/s,v=a.width/768,x=20*v,l="#111111",d="#ffffff",m="#d64b4b",M="#45b86f",o="#1253ae",h="#e0c24d",y=[l,m,M,o,h,"#4b0067"];y.sort(()=>Math.random()-.5);let b=n.length?n:["..."];i.clearRect(0,0,a.width,a.height),i.textAlign="center",i.textBaseline="middle",i.font=`bold ${22*v}px sans-serif`;for(let p=0;p<t*s;p+=1){let E=p%t,R=Math.floor(p/t),A=E*c,L=R*f;i.fillStyle=y[p%y.length],i.fillRect(A,L,c,f);let P=b[p%b.length],w=c-x*2;[h,M].includes(i.fillStyle)?i.fillStyle=l:i.fillStyle=d;let S=he(i,P,w),z=26*v,B=A+c/2,F=L+f/2-(S.length-1)*z/2;for(let U=0;U<S.length;U+=1)i.fillText(S[U],B,F+U*z)}e.needsUpdate=!0,cr(r,e)}function cr(r,e){r.bindTexture(r.TEXTURE_2D,e.texture),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,1),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e.canvas),e.needsUpdate=!1}function oe(r,e,n){let a=ir(r,r.VERTEX_SHADER,e),i=ir(r,r.FRAGMENT_SHADER,n);if(!a||!i)throw new Error("Shader creation failed");let t=r.createProgram();return r.attachShader(t,a),r.attachShader(t,i),r.linkProgram(t),r.getProgramParameter(t,r.LINK_STATUS)?t:(alert(`Unable to initialize the shader program: ${r.getProgramInfoLog(t)}`),null)}function ir(r,e,n){let a=r.createShader(e);if(!a)throw new Error("Unable to create shader");return r.shaderSource(a,n),r.compileShader(a),r.getShaderParameter(a,r.COMPILE_STATUS)?a:(alert(`An error occurred compiling the shaders: ${r.getShaderInfoLog(a)}`),r.deleteShader(a),null)}document.addEventListener("DOMContentLoaded",()=>{let r=document.getElementById("get_answer");r&&r.addEventListener("click",ar),de(),ar()});
